!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){(function(global){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Canvas=void 0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_react="undefined"!=typeof window?window.React:"undefined"!=typeof global?global.React:null,_react2=_interopRequireDefault(_react),_util=require("./util");exports.Canvas=(0,_util.withNodeReaderPropTypes)(function(props){var node=props.node,reader=(0,_util.readerFromProps)(props),key=(props.keyPrefix||"")+node.id;return _react2.default.createElement("div",{style:{position:props.responsiveEnabled?void 0:"relative",width:props.responsiveEnabled?"100%":parseInt(reader(node.width),10)+"px",height:props.responsiveEnabled?"100%":parseInt(reader(node.height),10)+"px"},id:(props.keyPrefix||"")+"canvas",key:key},_react2.default.createElement("div",_extends({style:{overflow:"hidden",width:"100%",height:"100%",position:"absolute",WebkitFontSmoothing:node.fontSmoothing&&"pixel"===node.fontSmoothing.value?"antialiased":void 0,backgroundColor:"#fff"}},(0,_util.getAnimationEventListeners)(props)),_react2.default.Children.toArray(props.children)),_react2.default.Children.toArray(props.bastards))})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./util":14}],2:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function styler(props){var node=props.node,reader=(0,_util.readerFromProps)(props),animations=(0,_util.getActivatedAnimations)(props);return(0,_objectAssign2.default)({},(0,_util.cssBorderStyle)(node,reader,animations))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Container=void 0;var _objectAssign=require("object-assign"),_objectAssign2=_interopRequireDefault(_objectAssign),_util=require("./util"),_Position=require("./Position"),_Position2=_interopRequireDefault(_Position),_Style=require("./Style"),_Style2=_interopRequireDefault(_Style);exports.Container=(0,_Position2.default)((0,_Style2.default)(styler)(_util.BasicElement))},{"./Position":6,"./Style":9,"./util":14,"object-assign":21}],3:[function(require,module,exports){(function(global){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function Linked(InnerNode){var Component=(0,_util.withNodeReaderPropTypes)(function(props){function linkIfNeeded(element){var link=reader(changeLinkEffect?changeLinkEffect.link:node.link);return link?_react2.default.createElement("a",_extends({target:"_top",href:props.decorateLink(link)},props.linkProps),element):element}var node=props.node,reader=(0,_util.readerFromProps)(props),animations=(0,_util.getActivatedAnimations)(props),changeLinkEffect=(0,_lodash2.default)(animations).flatMap(function(a){return a.effects||[]}).find(function(e){return"change"===e.type&&(!e.prop||"link"===e.prop)});return linkIfNeeded(_react2.default.createElement(InnerNode,props))});return Component.propTypes=(0,_objectAssign2.default)({},Component.propTypes,{decorateLink:_react2.default.PropTypes.func,linkProps:_react2.default.PropTypes.object}),Component.defaultProps=(0,_objectAssign2.default)({},Component.defaultProps,{decorateLink:function(link){return link},linkProps:{}}),Component}Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_util=require("./util");Object.keys(_util).forEach(function(key){"default"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _util[key]}})});var _Canvas=require("./Canvas");Object.keys(_Canvas).forEach(function(key){"default"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _Canvas[key]}})});var _Container=require("./Container");Object.keys(_Container).forEach(function(key){"default"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _Container[key]}})});var _Image=require("./Image");Object.keys(_Image).forEach(function(key){"default"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _Image[key]}})});var _Video=require("./Video");Object.keys(_Video).forEach(function(key){"default"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _Video[key]}})});var _Loop=require("./Loop");Object.keys(_Loop).forEach(function(key){"default"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _Loop[key]}})});var _Slide=require("./Slide");Object.keys(_Slide).forEach(function(key){"default"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _Slide[key]}})});var _Shape=require("./Shape");Object.keys(_Shape).forEach(function(key){"default"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _Shape[key]}})});var _Text=require("./Text");Object.keys(_Text).forEach(function(key){"default"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _Text[key]}})}),exports.Linked=Linked;var _react="undefined"!=typeof window?window.React:"undefined"!=typeof global?global.React:null,_react2=_interopRequireDefault(_react),_lodash="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,_lodash2=_interopRequireDefault(_lodash),_objectAssign=require("object-assign"),_objectAssign2=_interopRequireDefault(_objectAssign)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./Canvas":1,"./Container":2,"./Image":4,"./Loop":5,"./Shape":7,"./Slide":8,"./Text":10,"./Video":11,"./util":14,"object-assign":21}],4:[function(require,module,exports){(function(global){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function styler(props){var node=props.node,reader=(0,_util.readerFromProps)(props),animations=(0,_util.getActivatedAnimations)(props),changeSrcEffect=(0,_lodash2.default)(animations).flatMap(function(a){return a.effects||[]}).find(function(e){return"change"===e.type&&"image"===e.prop});return(0,_objectAssign2.default)({backgroundImage:"url("+reader(changeSrcEffect?changeSrcEffect.src:node.src)+")",backgroundSize:reader(node.imageStyle||"cover"),backgroundPosition:"center",backgroundRepeat:"no-repeat"},(0,_util.cssBorderStyle)(node,reader,animations))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Image=void 0;var _lodash="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,_lodash2=_interopRequireDefault(_lodash),_objectAssign=require("object-assign"),_objectAssign2=_interopRequireDefault(_objectAssign),_util=require("./util"),_Position=require("./Position"),_Position2=_interopRequireDefault(_Position),_Style=require("./Style"),_Style2=_interopRequireDefault(_Style);exports.Image=(0,_Position2.default)((0,_Style2.default)(styler)(_util.BasicElement))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./Position":6,"./Style":9,"./util":14,"object-assign":21}],5:[function(require,module,exports){(function(global){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function positiveMod(a,b){return(a%b+b)%b}function onNextFrame(code){setTimeout(requestAnimationFrame.bind(null,code),0)}function styler(props){var node=props.node,reader=(0,_util.readerFromProps)(props),animations=(0,_util.getActivatedAnimations)(props);return(0,_objectAssign2.default)({},(0,_util.cssBorderStyle)(node,reader,animations))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Loop=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_lodash="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,_lodash2=_interopRequireDefault(_lodash),_react="undefined"!=typeof window?window.React:"undefined"!=typeof global?global.React:null,_react2=_interopRequireDefault(_react),_objectAssign=require("object-assign"),_objectAssign2=_interopRequireDefault(_objectAssign),_invariant=require("invariant"),_invariant2=_interopRequireDefault(_invariant),_util=require("./util"),_Position=require("./Position"),_Position2=_interopRequireDefault(_Position),_Style=require("./Style"),_Style2=_interopRequireDefault(_Style),LoopComponent=function(_React$Component){function LoopComponent(props){_classCallCheck(this,LoopComponent);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(LoopComponent).call(this,props));return _this.state={autoOffset:0,transitionTs:0,inTransition:0},_this}return _inherits(LoopComponent,_React$Component),_createClass(LoopComponent,[{key:"getNode",value:function(){return(0,_objectAssign2.default)({},{progress:{value:!0},every:{value:"2"},trans:{value:"instant"},duration:{value:"0.5"}},this.props.node)}},{key:"componentDidMount",value:function(){var _props=this.props,animationsEnabled=_props.animationsEnabled,children=_props.children,node=this.getNode();if(animationsEnabled&&node.progress.value&&children.length>0){var seconds=parseFloat(node.every.value);seconds&&(this.interval=this.startInterval(parseInt(1e3*seconds,10)))}}},{key:"componentWillReceiveProps",value:function(nextProps){if(nextProps!==this.props){var oldSlideIndex=this.getSlideIndex(this.props),newSlideIndex=this.getSlideIndex(nextProps);if(oldSlideIndex!==newSlideIndex){var mostRecentEffect=(0,_lodash2.default)(this.getFrameEffects(nextProps)).head(),prevEffectTs=mostRecentEffect&&mostRecentEffect.frame&&"-"===mostRecentEffect.frame.value?mostRecentEffect.activatedTs:0;this.transition(oldSlideIndex,newSlideIndex,prevEffectTs>this.state.transitionTs);var specificFrameEffectIndex=this.getSpecificFrameEffectIndex(this.getFrameEffects(nextProps));if(null!==specificFrameEffectIndex){var offset=specificFrameEffectIndex-oldSlideIndex;this.setState({transitionTs:Date.now(),autoOffset:this.state.autoOffset-offset})}}}}},{key:"componentDidUpdate",value:function(prevProps,prevState){var _this2=this,wasPausedPreviously=this.isPaused(prevProps);if(!wasPausedPreviously&&this.isPaused(this.props))return 0!==this.state.inTransition&&this.setState({inTransition:0,autoOffset:this.state.autoOffset-1}),void(this.endTransitionTimeout&&clearTimeout(this.endTransitionTimeout));if(1===this.state.inTransition&&1!==prevState.inTransition)onNextFrame(function(){return _this2.setState({inTransition:2})});else if(2===this.state.inTransition&&1===prevState.inTransition)onNextFrame(function(){return _this2.setState({inTransition:3})});else if(3===this.state.inTransition&&2===prevState.inTransition){var node=this.getNode();this.endTransitionTimeout=setTimeout(this.setState.bind(this,{inTransition:0}),1e3*(parseFloat(node.duration.value)||.5))}}},{key:"componentWillUnmount",value:function(){this.props.animationsEnabled&&(this.interval&&clearInterval(this.interval),this.endTransitionTimeout&&clearTimeout(this.endTransitionTimeout))}},{key:"isPaused",value:function(props){var animations=(0,_util.getActivatedAnimations)(props),effects=(0,_lodash2.default)(animations).flatMap(function(a){return a.effects||[]}).value(),pauseLoopEffect=(0,_lodash2.default)(effects).find(function(e){return"pause"===e.type});return!!pauseLoopEffect}},{key:"startInterval",value:function(millis){var _this3=this;return setInterval(function(){if(!_this3.isPaused(_this3.props)){var oldSlideIndex=_this3.getSlideIndex(_this3.props),newSlideIndex=positiveMod(oldSlideIndex+1,_this3.props.children.length);_this3.transition(oldSlideIndex,newSlideIndex),_this3.setState({transitionTs:Date.now(),autoOffset:_this3.state.autoOffset+1})}},millis)}},{key:"transition",value:function(oldSlideIndex,newSlideIndex,isBackward){this.endTransitionTimeout&&(clearTimeout(this.endTransitionTimeout),this.endTransitionTimeout=null);var node=this.getNode();"instant"!==node.trans.value&&this.setState({inTransition:1,transitionFrom:oldSlideIndex,isBackward:!!isBackward})}},{key:"reverseIndex",value:function(i){return this.props.children.length-1-i}},{key:"getFrameEffects",value:function(props){var animations=(0,_util.getActivatedAnimations)(props),effects=(0,_lodash2.default)(animations).flatMap(function(a){return a.effects.map(function(e){return(0,_objectAssign2.default)({},e,{activatedTs:a.activatedTs,activatedCount:a.activatedCount})})||[]}).value();return(0,_lodash2.default)(effects).filter(function(e){return"frame"===e.type}).value()}},{key:"getSpecificFrameEffectIndex",value:function(frameEffects){var specificFrameEffect=frameEffects.length>0&&frameEffects[0].frame&&frameEffects[0].frame.value&&["+","-"].indexOf(frameEffects[0].frame.value)===-1&&frameEffects[0];return specificFrameEffect&&specificFrameEffect.activatedTs>this.state.transitionTs?this.reverseIndex(parseInt(specificFrameEffect.frame.value,10)||0):null}},{key:"getSlideIndex",value:function(props){var frameEffects=this.getFrameEffects(props),specificFrameEffectIndex=this.getSpecificFrameEffectIndex(frameEffects);if(null!==specificFrameEffectIndex)return specificFrameEffectIndex;var nextFrameEffectCount=(0,_lodash2.default)(frameEffects).filter(function(e){return!e.frame||!e.frame.value||"+"===e.frame.value}).map(function(e){return e.activatedCount}).reduce(function(a,b){return a+b},0),prevFrameEffectCount=(0,_lodash2.default)(frameEffects).filter(function(e){return e.frame&&"-"===e.frame.value}).map(function(e){return e.activatedCount}).reduce(function(a,b){return a+b},0),relativeFrameMovement=nextFrameEffectCount-prevFrameEffectCount;return this.reverseIndex(positiveMod(this.state.autoOffset+relativeFrameMovement,props.children.length))}},{key:"renderTransition",value:function(slideIndex,isIncoming,isInitial){var children=this.props.children,isBackward=this.state.isBackward,node=this.getNode(),translationValue=isIncoming&&(isInitial&&(isBackward?"-100":"100")||"0")||isInitial&&"0"||(isBackward?"100":"-100"),transformFunction="horz"===node.trans.value?"translateX":"vert"===node.trans.value?"translateY":(0,_invariant2.default)(!1,"Unexpected transition type '"+node.trans.value+"'");return _react2.default.createElement("div",{style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",transition:"transform "+node.duration.value+"s",transform:transformFunction+"("+translationValue+"%)"}},children[slideIndex])}},{key:"renderSlide",value:function(){if(0===this.props.children.length)return null;var childIndex=void 0!==this.props.node.slide?this.props.node.children.indexOf(this.props.node.slide):-1,slideIndex=positiveMod(childIndex>=0?childIndex:this.getSlideIndex(this.props),this.props.children.length),fromSlideIndex=this.state.transitionFrom;if(1===this.state.inTransition)return this.props.children[fromSlideIndex];if(fromSlideIndex!==slideIndex){if(2===this.state.inTransition)return _react2.default.Children.toArray([this.renderTransition(fromSlideIndex,!1,!0),this.renderTransition(slideIndex,!0,!0)]);if(3===this.state.inTransition)return _react2.default.Children.toArray([this.renderTransition(fromSlideIndex,!1,!1),this.renderTransition(slideIndex,!0,!1)])}return this.props.children[slideIndex]}},{key:"render",value:function(){var props=this.props,node=props.node;return _react2.default.createElement("div",{key:node.id,style:{position:"absolute",width:"100%",height:"100%",overflow:"hidden"}},this.renderSlide())}}]),LoopComponent}(_react2.default.Component);exports.Loop=(0,_Position2.default)((0,_Style2.default)(styler)((0,_util.withNodeReaderPropTypes)(LoopComponent)))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./Position":6,"./Style":9,"./util":14,invariant:20,"object-assign":21}],6:[function(require,module,exports){(function(global){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectWithoutProperties(obj,keys){var target={};for(var i in obj)keys.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(obj,i)&&(target[i]=obj[i]);return target}function Position(Component){function Positioned(props){function wrap(element){return wrapper?wrapper(element):element}function readDirProp(dir){var movedNode=_lodash2.default.merge({},node[dir],moveToEffect&&moveToEffect.position&&moveToEffect.position[dir],moveFromEffect&&!moveFromEffect.active&&moveFromEffect.position?moveFromEffect.position[dir]:void 0);return(0,_util.readTypedProp)(reader,node[dir]&&movedNode,{missingValue:"auto"})}var wrapper=props.wrapper,bastards=props.bastards,remainingProps=_objectWithoutProperties(props,["wrapper","bastards"]),node=Object.assign({visible:Object.assign({value:!0},remainingProps.node.visible)},remainingProps.node),reader=(0,_util.readerFromProps)(remainingProps),animations=(0,_util.getAnimations)(remainingProps),effects=_lodash2.default.flatMap(animations,function(animation){return(animation.effects||[]).map(function(e){return(0,_objectAssign2.default)({},e,{active:animation.active})})}),activatedAnimations=(0,_util.getActivatedAnimations)(remainingProps),activatedEffects=_lodash2.default.flatMap(activatedAnimations,function(a){return a.effects||[]}),rawChangeVisibleEffect=(0,_lodash2.default)(activatedAnimations).flatMap(function(a){return a.effects||[]}).find(function(e){return"change"===e.type&&"visible"===e.prop}),changeVisibleEffect=rawChangeVisibleEffect&&Object.assign({visible:Object.assign({value:!0},rawChangeVisibleEffect.visible)},rawChangeVisibleEffect),moveToEffect=activatedEffects.find(function(e){return"moveto"===e.type}),moveFromEffect=effects.find(function(e){return"movefrom"===e.type}),transforms=[],transitions=[];"middle"===reader(node.vAlign)&&transforms.push("translateY(-50%)"),"center"===reader(node.hAlign)&&transforms.push("translateX(-50%)"),moveToEffect&&["top","right","bottom","left"].forEach(function(dir){transitions.push(dir+" "+moveToEffect.duration+" "+(moveToEffect.accel||"ease-in-out"))}),moveFromEffect&&moveFromEffect.active&&["top","right","bottom","left"].forEach(function(dir){transitions.push(dir+" "+moveFromEffect.duration+" "+(moveFromEffect.accel||"ease-in-out"))});var style={position:"absolute",width:(0,_util.readTypedProp)(reader,node.width,{missingValue:"auto"}),height:(0,_util.readTypedProp)(reader,node.height,{missingValue:"auto"}),top:readDirProp("top"),right:readDirProp("right"),bottom:readDirProp("bottom"),left:readDirProp("left"),transform:transforms.length>0?transforms.join(" "):void 0,WebkitTransform:transforms.length>0?transforms.join(" "):void 0,transition:transitions.length>0?transitions.join(", "):void 0,display:reader(changeVisibleEffect?changeVisibleEffect.visible:node.visible)?void 0:"none"};return wrap(_react2.default.createElement("div",{style:style},_react2.default.createElement(Component,remainingProps),_react2.default.Children.toArray(bastards)))}return Positioned.propTypes=_extends({},Component.propTypes,{wrapper:_react2.default.PropTypes.func,bastards:_react2.default.PropTypes.node}),Positioned.defaultProps=_extends({},Component.defaultProps),Positioned}Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};exports.default=Position;var _lodash="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,_lodash2=_interopRequireDefault(_lodash),_react="undefined"!=typeof window?window.React:"undefined"!=typeof global?global.React:null,_react2=_interopRequireDefault(_react),_objectAssign=require("object-assign"),_objectAssign2=_interopRequireDefault(_objectAssign),_util=require("./util");module.exports=exports.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./util":14,"object-assign":21}],7:[function(require,module,exports){(function(global){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function styler(props){var node=props.node,reader=(0,_util.readerFromProps)(props),animations=(0,_util.getActivatedAnimations)(props),changeFillEffect=(0,_lodash2.default)(animations).flatMap(function(a){return a.effects||[]}).find(function(e){return"change"===e.type&&"fill"===e.prop});return(0,_objectAssign2.default)({},(0,_util.cssBorderStyle)(node,reader,animations),(0,_util.cssBackgroundStyle)(node,reader),changeFillEffect?{backgroundColor:"color"===changeFillEffect.fill.type||"dynamic"===changeFillEffect.fill.type?reader(changeFillEffect.fill):"transparent",backgroundImage:"image"===changeFillEffect.fill.type||"dynamic"===changeFillEffect.fill.type?"url("+reader(changeFillEffect.fill)+")":"none"}:{})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Shape=void 0;var _lodash="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,_lodash2=_interopRequireDefault(_lodash),_objectAssign=require("object-assign"),_objectAssign2=_interopRequireDefault(_objectAssign),_util=require("./util"),_Position=require("./Position"),_Position2=_interopRequireDefault(_Position),_Style=require("./Style"),_Style2=_interopRequireDefault(_Style);exports.Shape=(0,_Position2.default)((0,_Style2.default)(styler)(_util.BasicElement))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./Position":6,"./Style":9,"./util":14,"object-assign":21}],8:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function styler(props){return{}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Slide=void 0;var _util=require("./util"),_Position=require("./Position"),_Position2=_interopRequireDefault(_Position),_Style=require("./Style"),_Style2=_interopRequireDefault(_Style);exports.Slide=(0,_Position2.default)((0,_Style2.default)(styler)(_util.BasicElement))},{"./Position":6,"./Style":9,"./util":14}],9:[function(require,module,exports){(function(global){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectWithoutProperties(obj,keys){var target={};for(var i in obj)keys.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(obj,i)&&(target[i]=obj[i]);return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function Style(styler){return function(Component){var Styled=function(_React$Component){function Styled(){var _Object$getPrototypeO,_temp,_this,_ret;_classCallCheck(this,Styled);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _temp=_this=_possibleConstructorReturn(this,(_Object$getPrototypeO=Object.getPrototypeOf(Styled)).call.apply(_Object$getPrototypeO,[this].concat(args))),_this.onElementLoaded=function(element){_this.element=element},_this.onSwipeHandler=function(event){var direction=event.direction,swipeDirections={UP:1,LEFT:2,DOWN:3,RIGHT:4},_getAnimationEventLis=(0,_util.getAnimationEventListeners)(_this.props),onSwipeLeft=_getAnimationEventLis.onSwipeLeft,onSwipeRight=_getAnimationEventLis.onSwipeRight,onSwipeUp=_getAnimationEventLis.onSwipeUp,onSwipeDown=_getAnimationEventLis.onSwipeDown;switch(direction){case swipeDirections.LEFT:onSwipeLeft&&onSwipeLeft();break;case swipeDirections.RIGHT:onSwipeRight&&onSwipeRight();break;case swipeDirections.UP:onSwipeUp&&onSwipeUp();break;case swipeDirections.DOWN:onSwipeDown&&onSwipeDown()}},_ret=_temp,_possibleConstructorReturn(_this,_ret)}return _inherits(Styled,_React$Component),_createClass(Styled,[{key:"componentDidMount",value:function(){var _getAnimationEventLis2=(0,_util.getAnimationEventListeners)(this.props),onSwipeLeft=_getAnimationEventLis2.onSwipeLeft,onSwipeRight=_getAnimationEventLis2.onSwipeRight,onSwipeUp=_getAnimationEventLis2.onSwipeUp,onSwipeDown=_getAnimationEventLis2.onSwipeDown;if((onSwipeLeft||onSwipeRight||onSwipeUp||onSwipeDown)&&"undefined"!=typeof window){var Hammer="undefined"!=typeof window?window.Hammer:"undefined"!=typeof global?global.Hammer:null;this.hammer=new Hammer(this.element),this.hammer.on("swipe",this.onSwipeHandler)}}},{key:"componentWillUnmount",value:function(){this.hammer&&(this.hammer.off("swipe"),this.hammer.destroy())}},{key:"render",value:function(){var props=this.props,node=props.node,reader=(0,_util.readerFromProps)(props),transitions=[],transforms=[],animations=(0,_util.getActivatedAnimations)(props),fadeEffect=(0,_lodash2.default)(animations).flatMap(function(a){return a.effects||[]}).find(function(e){return"fade"===e.type}),scaleEffect=(0,_lodash2.default)(animations).flatMap(function(a){return a.effects||[]}).find(function(e){return"scale"===e.type}),rotation=parseInt(reader(node.rotation),10);0!==rotation&&rotation>=-180&&rotation<=180&&transforms.push("rotate("+rotation+"deg)"),scaleEffect&&(transitions.push("transform "+scaleEffect.duration),transforms.push("scale("+scaleEffect.factor+", "+scaleEffect.factor+")")),fadeEffect&&transitions.push("opacity "+fadeEffect.duration);var customCss=(0,_styleParser2.default)(reader(node.css)),style=_extends({width:"100%",height:"100%",position:"relative",transform:transforms.length>0?transforms.join(" "):void 0,WebkitTransform:transforms.length>0?transforms.join(" "):void 0,opacity:fadeEffect?fadeEffect.opacity:(reader(node.opacity)||0)/100,transition:transitions.length>0?transitions.join(", "):void 0,overflow:reader(node.mask)?"hidden":"visible"},styler(props),customCss),_getAnimationEventLis3=(0,_util.getAnimationEventListeners)(props),eventListeners=(_getAnimationEventLis3.onSwipeLeft,_getAnimationEventLis3.onSwipeRight,_getAnimationEventLis3.onSwipeUp,_getAnimationEventLis3.onSwipeDown,_objectWithoutProperties(_getAnimationEventLis3,["onSwipeLeft","onSwipeRight","onSwipeUp","onSwipeDown"]));return _react2.default.createElement("div",_extends({ref:this.onElementLoaded,style:style},eventListeners),_react2.default.createElement(Component,props))}}]),Styled}(_react2.default.Component);return Styled.propTypes=_extends({},Component.propTypes),Styled.defaultProps=_extends({},Component.defaultProps),Styled}}Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();exports.default=Style;var _lodash="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,_lodash2=_interopRequireDefault(_lodash),_react="undefined"!=typeof window?window.React:"undefined"!=typeof global?global.React:null,_react2=_interopRequireDefault(_react),_styleParser=require("./style-parser"),_styleParser2=_interopRequireDefault(_styleParser),_util=require("./util");module.exports=exports.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./style-parser":13,"./util":14}],10:[function(require,module,exports){(function(global){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function styler(props){function translateFont(font){return fontMap[font]||font}function variantToWeight(variant){return variant&&parseInt(variant,10)?parseInt(variant,10):400}function variantToStyle(variant){return variant&&variant.indexOf("italic")!==-1?"italic":"normal"}var DEFAULT_TEXT_STYLE={text:"Text",font:"Arimo",weight:400,color:"#000",size:36,width:{type:"auto",value:100},height:{type:"auto",value:100},letterSpacing:"normal",lineHeight:"auto",textAlign:"left",textWidth:"auto",textStyle:{value:{underline:!1,smallCaps:!1,italic:!1,uppercase:!1}}},reader=(0,_util.readerFromProps)(props),node=(0,_objectAssign2.default)({},DEFAULT_TEXT_STYLE,props.node),fontVariant=reader(node.fontVariant),fontMap={arial:"Arimo","basis grotesque":"Muli",didot:"Arapey","Proxima Nova":"Roboto","proxima-nova":"Roboto",futura:"Didact Gothic",courier:"Cousine","comic sans ms":"Bangers",impact:"Anton",tahoma:"Lato","trebuchet ms":"Arimo",times:"Tinos",verdana:"Open Sans",georgia:"Playfair Display",palatino:"Merriweather","helvetica neue":"Arimo","gill sans":"Lato"};return{fontFamily:translateFont(reader(node.font)),fontWeight:variantToWeight(fontVariant),color:reader(node.color),fontSize:(0,_util.numberWithDefaultSuffix)(props,reader(node.size),"px"),textAlign:reader(node.textAlign),letterSpacing:(0,_util.numberWithDefaultSuffix)(props,reader(node.letterSpacing),"px"),lineHeight:["normal","auto"].indexOf(reader(node.lineHeight))!==-1?"normal":(0,_util.numberWithDefaultSuffix)(props,reader(node.lineHeight),"px"),textDecoration:reader(node.textStyle.value.underline)?"underline":"none",textTransform:reader(node.textStyle.value.uppercase)?"uppercase":"none",
fontVariant:reader(node.textStyle.value.smallCaps)?"small-caps":"normal",fontStyle:variantToStyle(fontVariant),whiteSpace:"auto"===(0,_util.readTypedProp)(reader,node.width,{missingValue:"auto"})?"nowrap":void 0}}function filterText(text){var lines=text.split(/\n/);return lines.map(function(line,i){return _react2.default.createElement("div",{key:i},line.length>0?line:"​")})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Text=exports.TextComponent=void 0;var _react="undefined"!=typeof window?window.React:"undefined"!=typeof global?global.React:null,_react2=_interopRequireDefault(_react),_lodash="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,_lodash2=_interopRequireDefault(_lodash),_objectAssign=require("object-assign"),_objectAssign2=_interopRequireDefault(_objectAssign),_util=require("./util"),_Position=require("./Position"),_Position2=_interopRequireDefault(_Position),_Style=require("./Style"),_Style2=_interopRequireDefault(_Style),TextComponent=exports.TextComponent=(0,_util.withNodeReaderPropTypes)(function(props){var node=props.node,reader=(0,_util.readerFromProps)(props),animations=(0,_util.getActivatedAnimations)(props),changeTextEffect=(0,_lodash2.default)(animations).flatMap(function(a){return a.effects||[]}).find(function(e){return"change"===e.type&&"text"===e.prop});return _react2.default.createElement("div",null,filterText(reader(changeTextEffect?changeTextEffect.text:node.text)))});exports.Text=(0,_Position2.default)((0,_Style2.default)(styler)(TextComponent))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./Position":6,"./Style":9,"./util":14,"object-assign":21}],11:[function(require,module,exports){(function(global){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function styler(props){var node=props.node,reader=(0,_util.readerFromProps)(props),animations=(0,_util.getActivatedAnimations)(props);return(0,_objectAssign2.default)({overflow:"hidden",display:"flex"},(0,_util.cssBorderStyle)(node,reader,animations))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Video=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react="undefined"!=typeof window?window.React:"undefined"!=typeof global?global.React:null,_react2=_interopRequireDefault(_react),_lodash="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,_lodash2=_interopRequireDefault(_lodash),_objectAssign=require("object-assign"),_objectAssign2=_interopRequireDefault(_objectAssign),_util=require("./util"),_Position=require("./Position"),_Position2=_interopRequireDefault(_Position),_Style=require("./Style"),_Style2=_interopRequireDefault(_Style),VideoComponent=function(_React$Component){function VideoComponent(props){_classCallCheck(this,VideoComponent);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(VideoComponent).call(this,props));return _this.onVideoMounted=function(videoElement){_this.videoElement=videoElement},_this.state={videoAction:""},_this}return _inherits(VideoComponent,_React$Component),_createClass(VideoComponent,[{key:"componentWillReceiveProps",value:function(nextProps){var activatedAnimations=(0,_util.getActivatedAnimations)(nextProps),effects=(0,_lodash2.default)(activatedAnimations).flatMap(function(a){return a.effects||[]}).value(),firstVideoEffect=(0,_lodash2.default)(effects).find(function(e){return"pause"===e.type||"play"===e.type});firstVideoEffect&&this.setState({videoAction:firstVideoEffect.type})}},{key:"componentDidUpdate",value:function(){var videoAction=this.state.videoAction,animationsEnabled=this.props.animationsEnabled;animationsEnabled&&this.videoElement&&("pause"===videoAction?this.videoElement.pause():this.videoElement.paused&&"play"===videoAction&&this.videoElement.play())}},{key:"render",value:function(){var reader=(0,_util.readerFromProps)(this.props),node=this.props.node;return _react2.default.createElement("video",{ref:this.onVideoMounted,style:{width:"100%",height:"100%",objectFit:reader(node.videoStyle)},autoPlay:reader(node.autoPlay)&&this.props.animationsEnabled,loop:reader(node.loop),muted:!0,src:reader(node.src)})}}]),VideoComponent}(_react2.default.Component);exports.Video=(0,_Position2.default)((0,_Style2.default)(styler)(VideoComponent))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./Position":6,"./Style":9,"./util":14,"object-assign":21}],12:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _CreativeNode=require("./CreativeNode");Object.keys(_CreativeNode).forEach(function(key){"default"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _CreativeNode[key]}})})},{"./CreativeNode":3}],13:[function(require,module,exports){(function(global){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function toReactStyleName(cssStyleName){return 0===cssStyleName.indexOf("-ms-")&&(cssStyleName=cssStyleName.slice(1)),cssStyleName.replace(/-(.)/g,function(match,nextChar){return nextChar.toUpperCase()})}function parseStyles(styles){if(styles){var rules=styles.split(";").map(function(rule){return rule.split(":")}).filter(function(kv){return 2===kv.length}).map(function(_ref){var _ref2=_slicedToArray(_ref,2),k=_ref2[0],v=_ref2[1];return[k.trim(),v.trim()]}).filter(function(_ref3){var _ref4=_slicedToArray(_ref3,2),k=_ref4[0],v=_ref4[1];return k.length>0&&v.length>0});return(0,_lodash2.default)(rules).map(function(_ref5){var _ref6=_slicedToArray(_ref5,2),k=_ref6[0],v=_ref6[1];return[toReactStyleName(k),v]}).fromPairs().value()}}Object.defineProperty(exports,"__esModule",{value:!0});var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{!_n&&_i.return&&_i.return()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr))return arr;if(Symbol.iterator in Object(arr))return sliceIterator(arr,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();exports.default=parseStyles;var _lodash="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,_lodash2=_interopRequireDefault(_lodash);module.exports=exports.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],14:[function(require,module,exports){(function(global){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function noData(expr){}function evaluateExpression(a,op,b){switch(op){case"+":return a+b;case"-":return a-b;case"*":return a*b;case"/":return a/b}return a}function calculate(value,expression){if(!expression)return value;var number=parseFloat(value),regex=/[+\-*\/][0-9.]+/g,matchResult=expression.match(regex);if(matchResult)for(var i=0;i<matchResult.length;i++){var calculation=matchResult[i],operator=calculation[0],operand=parseFloat(calculation.substr(1));number=evaluateExpression(number,operator,operand)}return number}function evaluateCPE(expression,fetchData){var env={queries:function(name,rank,field){return fetchData(field,rank,name)}};return _cpeParser2.default.evaluate.fromString(expression,env)}function numberWithDefaultSuffix(props,str,suffix){var num=parseFloat(str);if(num.toString()===str)return""+str+suffix;if(_lodash2.default.endsWith(str,"cw")){var canvas=props.nodes.find(function(n){return"canvas"===n.type}),scaleFactor=props.win&&props.win===props.win.top?canvas.width.value/props.win.innerWidth:1;return num*scaleFactor+"vw"}return str}function readValueWithData(value){var fetchData=arguments.length<=1||void 0===arguments[1]?noData:arguments[1];return void 0===value||"number"==typeof value||"string"==typeof value?value:value.hasOwnProperty("cpe")&&"dynamic"===value.type?evaluateCPE(value.cpe,fetchData):value.hasOwnProperty("field")&&"dynamic"===value.type?(value.pre||"")+calculate(fetchData(value.field,value.rank),value.calc).toString()+(value.post||""):(value.hasOwnProperty("value")&&(value=value.value),value)}function readValue(value){var fetchData=arguments.length<=1||void 0===arguments[1]?noData:arguments[1];try{return readValueWithData(value,fetchData)}catch(err){if(err instanceof NoDataError)return value.fallback||"";throw err}}function withNodeReaderPropTypes(f,parent){var PROP_TYPES={node:_react2.default.PropTypes.object.isRequired,reader:_react2.default.PropTypes.func,data:_react2.default.PropTypes.any,wrapper:_react2.default.PropTypes.func},DEFAULT_PROPS={reader:readValue};return f.propTypes=parent&&parent.hasOwnProperty("propTypes")?parent.propTypes:PROP_TYPES,f.defaultProps=parent&&parent.hasOwnProperty("propTypes")?parent.defaultProps:DEFAULT_PROPS,f}function readerFromProps(props){var reader=props.reader||readValue;if(props.data){var _ret=function(){var fetchData=props.data;return"function"!=typeof fetchData&&(fetchData=Array.isArray(fetchData)?function(key,rank){return(props.data[(rank||1)-1]||{})[key]}:function(key,rank,query){return query&&"_"!==query||(query=""),((props.data[query]||[])[(rank||1)-1]||{})[key]}),{v:function(value){return reader(value,function(){var dataResult=fetchData.apply(void 0,arguments);if(void 0===dataResult)throw new NoDataError(arguments.length<=0?void 0:arguments[0]);return dataResult})}}}();if("object"===("undefined"==typeof _ret?"undefined":_typeof(_ret)))return _ret.v}return reader}function getAnimationEventListeners(props){var animationsToTrigger=props.animations?props.animations.filter(function(a){return a.trigger&&"interaction"===a.trigger.type&&a.trigger.value&&a.trigger.value.target===props.node.id}):[],clickTriggers=animationsToTrigger.filter(function(a){return"click"===a.trigger.value.event}),hoverTriggers=animationsToTrigger.filter(function(a){return!a.trigger.value.event||"hover"===a.trigger.value.event}),swipeLeftTriggers=animationsToTrigger.filter(function(a){return"swipeleft"===a.trigger.value.event}),swipeRightTriggers=animationsToTrigger.filter(function(a){return"swiperight"===a.trigger.value.event}),swipeUpTriggers=animationsToTrigger.filter(function(a){return"swipeup"===a.trigger.value.event}),swipeDownTriggers=animationsToTrigger.filter(function(a){return"swipedown"===a.trigger.value.event}),eventListeners={};return clickTriggers.length>0&&(eventListeners.onClick=function(event){clickTriggers.forEach(function(a){a.activate(!0)})}),swipeLeftTriggers.length>0&&(eventListeners.onSwipeLeft=function(event){swipeLeftTriggers.forEach(function(a){a.activate(!0)})}),swipeRightTriggers.length>0&&(eventListeners.onSwipeRight=function(event){swipeRightTriggers.forEach(function(a){a.activate(!0)})}),swipeUpTriggers.length>0&&(eventListeners.onSwipeUp=function(event){swipeUpTriggers.forEach(function(a){a.activate(!0)})}),swipeDownTriggers.length>0&&(eventListeners.onSwipeDown=function(event){swipeDownTriggers.forEach(function(a){a.activate(!0)})}),hoverTriggers.length>0&&(eventListeners.onMouseEnter=function(event){hoverTriggers.forEach(function(a){a.activate(!0)})},eventListeners.onMouseLeave=function(event){hoverTriggers.filter(function(a){var trigger=(0,_objectAssign2.default)({revert:!0},a.trigger.value);return trigger.revert}).forEach(function(a){a.activate(!1)})}),eventListeners}function readTypedProp(reader,prop,_ref){var _ref$missingType=_ref.missingType,missingType=void 0===_ref$missingType?void 0:_ref$missingType,_ref$missingValue=_ref.missingValue,missingValue=void 0===_ref$missingValue?void 0:_ref$missingValue,_ref$autoType=_ref.autoType,autoType=void 0===_ref$autoType?"auto":_ref$autoType;if(void 0===prop)return missingValue;var propType=reader(prop.type);return propType===autoType?propType:"dynamic"===propType?reader(prop):""+reader(prop)+("static"!==propType&&propType||missingType)}function cssBorderStyle(node,reader,animations){var rawChangeBorderEffect=animations&&(0,_lodash2.default)(animations).flatMap(function(a){return a.effects||[]}).find(function(e){return"change"===e.type&&"border"===e.prop}),changeBorderEffect=rawChangeBorderEffect&&_objectAssign2.default.apply(void 0,[{borderSize:{value:0},borderColor:{value:"#000"}}].concat(_toConsumableArray(rawChangeBorderEffect)));return(0,_objectAssign2.default)({borderWidth:readTypedProp(reader,node.borderSize,{missingType:"px"}),borderColor:reader(node.borderColor),borderRadius:readTypedProp(reader,node.cornerRadius,{missingType:"px"}),borderStyle:"solid"},changeBorderEffect?{borderWidth:reader(changeBorderEffect.borderSize),borderColor:reader(changeBorderEffect.borderColor)}:{})}function cssBackgroundStyle(node,reader){return{backgroundColor:"color"===node.fill.type||"dynamic"===node.fill.type?reader(node.fill):"transparent",backgroundImage:"image"===node.fill.type||"dynamic"===node.fill.type?"url("+reader(node.fill)+")":"none",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}function getAnimations(props){return props.animations?props.animations.filter(function(a){return a.node===props.node.id}):[]}function getActivatedAnimations(props){return props.animations?(0,_lodash2.default)(props.animations).filter(function(a){return a.node===props.node.id&&a.active}).orderBy("activatedTs","desc").value():[]}function deepAssign(){return _lodash2.default.merge.apply(_lodash2.default,arguments)}function applyResponsiveness(nodes,width){var canvas=nodes.find(function(n){return"canvas"===n.type}),breakpoints=canvas.sizing&&"responsive"===canvas.sizing.value?canvas.breakpoints||[]:[],activeBreakpoints=(0,_lodash2.default)(breakpoints).filter(function(b){return width>=b.value}).orderBy("value").value();return 0===activeBreakpoints.length?nodes:nodes.map(function(node){var overridden=node;return activeBreakpoints.forEach(function(b){var overrides=(b.overrides||{})[node.id];overrides&&(overridden=deepAssign({},overridden,overrides))}),overridden})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.BasicElement=void 0;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj};exports.numberWithDefaultSuffix=numberWithDefaultSuffix,exports.readValueWithData=readValueWithData,exports.readValue=readValue,exports.withNodeReaderPropTypes=withNodeReaderPropTypes,exports.readerFromProps=readerFromProps,exports.getAnimationEventListeners=getAnimationEventListeners,exports.readTypedProp=readTypedProp,exports.cssBorderStyle=cssBorderStyle,exports.cssBackgroundStyle=cssBackgroundStyle,exports.getAnimations=getAnimations,exports.getActivatedAnimations=getActivatedAnimations,exports.deepAssign=deepAssign,exports.applyResponsiveness=applyResponsiveness;var _react="undefined"!=typeof window?window.React:"undefined"!=typeof global?global.React:null,_react2=_interopRequireDefault(_react),_lodash="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,_lodash2=_interopRequireDefault(_lodash),_cpeParser=require("cpe-parser"),_cpeParser2=_interopRequireDefault(_cpeParser),_objectAssign=require("object-assign"),_objectAssign2=_interopRequireDefault(_objectAssign),NoDataError=function NoDataError(message){_classCallCheck(this,NoDataError),this.message=message};exports.BasicElement=withNodeReaderPropTypes(function(props){return _react2.default.createElement("div",null,_react2.default.Children.toArray(props.children))})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"cpe-parser":19,"object-assign":21}],15:[function(require,module,exports){(function(global){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectWithoutProperties(obj,keys){var target={};for(var i in obj)keys.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(obj,i)&&(target[i]=obj[i]);return target}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.CreativeReact=exports.LinkedCreativeReactVisitor=exports.CreativeReactVisitor=exports.CreativeNode=void 0;var _get=function get(object,property,receiver){null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0===desc){var parent=Object.getPrototypeOf(object);return null===parent?void 0:get(parent,property,receiver)}if("value"in desc)return desc.value;var getter=desc.get;if(void 0!==getter)return getter.call(receiver)},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_lodash="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,_lodash2=_interopRequireDefault(_lodash),_react="undefined"!=typeof window?window.React:"undefined"!=typeof global?global.React:null,_react2=_interopRequireDefault(_react),_objectAssign=require("object-assign"),_objectAssign2=_interopRequireDefault(_objectAssign),_creativeVisitor=require("creative-visitor"),_CreativeNode=require("./components/CreativeNode"),CreativeNode=_interopRequireWildcard(_CreativeNode);exports.CreativeNode=CreativeNode;var CreativeReactVisitor=exports.CreativeReactVisitor=function(_CreativeVisitor){function CreativeReactVisitor(){var _Object$getPrototypeO;_classCallCheck(this,CreativeReactVisitor);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _this=_possibleConstructorReturn(this,(_Object$getPrototypeO=Object.getPrototypeOf(CreativeReactVisitor)).call.apply(_Object$getPrototypeO,[this].concat(args)));return _this.nodeComponents=_this.getNodeComponentMapping(),_this}return _inherits(CreativeReactVisitor,_CreativeVisitor),_createClass(CreativeReactVisitor,[{key:"getNodeComponentMapping",value:function(){return CreativeReactVisitor.DEFAULT_NODE_COMPONENT_MAPPING}},{key:"getElementType",value:function(node){return this.nodeComponents[this.getType(node)]}},{key:"enter",value:function(node){return void 0!==this.getElementType(node)}},{key:"exit",value:function(node,children,extraProps){return _react2.default.createElement(this.getElementType(node),(0,_objectAssign2.default)({node:node},extraProps),_react2.default.Children.toArray(children))}}]),CreativeReactVisitor}(_creativeVisitor.CreativeVisitor);CreativeReactVisitor.DEFAULT_NODE_COMPONENT_MAPPING={canvas:CreativeNode.Canvas,container:CreativeNode.Container,image:CreativeNode.Image,video:CreativeNode.Video,loop:CreativeNode.Loop,slide:CreativeNode.Slide,shape:CreativeNode.Shape,text:CreativeNode.Text};var LinkedCreativeReactVisitor=exports.LinkedCreativeReactVisitor=function(_CreativeReactVisitor){function LinkedCreativeReactVisitor(){return _classCallCheck(this,LinkedCreativeReactVisitor),_possibleConstructorReturn(this,Object.getPrototypeOf(LinkedCreativeReactVisitor).apply(this,arguments))}return _inherits(LinkedCreativeReactVisitor,_CreativeReactVisitor),_createClass(LinkedCreativeReactVisitor,[{key:"getNodeComponentMapping",value:function(){var originalMapping=_get(Object.getPrototypeOf(LinkedCreativeReactVisitor.prototype),"getNodeComponentMapping",this).call(this);return(0,_lodash2.default)(originalMapping).mapValues(function(component){return CreativeNode.Linked(component)}).value()}}]),LinkedCreativeReactVisitor}(CreativeReactVisitor),CreativeReact=exports.CreativeReact=function(_React$Component){function CreativeReact(props){_classCallCheck(this,CreativeReact);var _this3=_possibleConstructorReturn(this,Object.getPrototypeOf(CreativeReact).call(this,props)),animations=void 0;return props.animationsEnabled&&(animations=(0,_lodash2.default)(props.nodes).filter(function(n){return n.animations&&n.animations.length>0}).flatMap(function(n){return n.animations.map(function(a){return(0,_objectAssign2.default)({},a,{node:n.id})})}).map(function(a,i){return(0,_objectAssign2.default)({},a,{activate:_this3.activateAnimation.bind(_this3,i)})}).value()),_this3.state={animations:animations,width:0},_this3}return _inherits(CreativeReact,_React$Component),_createClass(CreativeReact,[{key:"activateAnimation",value:function(i,isActive){this.setState(function(previousState){return{animations:[].concat(_toConsumableArray(previousState.animations.slice(0,i)),[(0,_objectAssign2.default)({},previousState.animations[i],{active:isActive,activatedTs:Date.now(),activatedCount:(previousState.animations[i]&&previousState.animations[i].activatedCount||0)+(isActive?1:-1)})],_toConsumableArray(previousState.animations.slice(i+1)))}})}},{key:"onBreakpointChange",value:function(win){this.setState({width:win.innerWidth})}},{key:"componentDidMount",value:function(){var _this4=this,animations=this.state.animations;animations&&animations.length>0&&setTimeout(function(){_this4.setState({animations:animations.map(function(a){return a.trigger&&"auto"===a.trigger.type?(0,_objectAssign2.default)({},a,{active:!0}):a})})},10),this.props.responsiveEnabled&&this.props.win&&!function(){var onBreakpointChange=_this4.onBreakpointChange.bind(_this4,_this4.props.win),canvas=_this4.props.nodes.find(function(n){return"canvas"===n.type});(canvas.breakpoints||[]).forEach(function(b){var mquery="(min-width: "+b.value+"px)",mql=_this4.props.win.matchMedia(mquery);mql.addListener(onBreakpointChange)}),onBreakpointChange()}(),this.preloadImages(animations)}},{key:"preloadImages",value:function(animations){function readImageUrlFromImageElement(el){return reader(el.src)}function readImageUrlFromShapeElement(el){return"image"===el.fill.type||"dynamic"===el.fill.type?reader(el.fill):null}var reader=CreativeNode.readerFromProps(this.props),imagesFromImageElements=(0,_lodash2.default)(this.props.nodes).filter(function(n){return"image"===n.type}).map(readImageUrlFromImageElement).value(),imagesFromShapeElements=(0,_lodash2.default)(this.props.nodes).filter(function(n){return"shape"===n.type}).map(readImageUrlFromShapeElement).value(),animationEffects=(0,_lodash2.default)(animations||[]).flatMap(function(a){return a.effects||[]}).value(),imagesFromImageChangeEffects=(0,_lodash2.default)(animationEffects).filter(function(e){return"change"===e.type&&"image"===e.prop}).map(readImageUrlFromImageElement).value(),imagesFromShapeFillEffects=(0,_lodash2.default)(animationEffects).filter(function(e){return"change"===e.type&&"fill"===e.prop}).map(readImageUrlFromShapeElement).value(),imageUrlsToPreload=(0,_lodash2.default)(imagesFromImageElements).concat(imagesFromShapeElements).concat(imagesFromImageChangeEffects).concat(imagesFromShapeFillEffects).uniq().filter(function(u){return u&&u.length>0}).value();this.preloadedImages=imageUrlsToPreload.map(function(url){var image=new Image;return image.src=url,image})}},{key:"getGoogleFontCss",value:function(nodes){function readFamilyAndVariant(node){var family=node.font&&node.font.value||null,variant=node.fontVariant&&node.fontVariant.value||null;return null===family||node.fontVariant&&node.fontVariant.url?null:null===variant?family:family+":"+variant}var fontMap={arial:"Arimo","basis grotesque":"Muli",didot:"Arapey","Proxima Nova":"Roboto","proxima-nova":"Roboto",futura:"Didact Gothic",courier:"Cousine","comic sans ms":"Bangers",impact:"Anton",tahoma:"Lato","trebuchet ms":"Arimo",times:"Tinos",verdana:"Open Sans",georgia:"Playfair Display",palatino:"Merriweather","helvetica neue":"Arimo","gill sans":"Lato"},googleFontsUsed=(0,_lodash2.default)(nodes).filter(function(n){return"text"===n.type}).map(readFamilyAndVariant).filter(function(f){return null!==f}).map(function(f){return fontMap[f]||f}).uniq().value(),googleFontCss=googleFontsUsed.map(function(family){return _react2.default.createElement("link",{key:family,rel:"stylesheet",href:"https://fonts.googleapis.com/css?family="+encodeURIComponent(family)})});return googleFontCss}},{key:"getCustomFontCss",value:function(nodes){function readFamilyAndVariant(node){var family=node.font&&node.font.value||null,variant=node.fontVariant&&node.fontVariant.value||null,url=node.fontVariant&&node.fontVariant.url||null;return null===family||null===variant||null===url?null:{family:family,weight:parseInt(variant,10)||400,style:variant.indexOf("italic")!==-1?"italic":"normal",url:url}}function getFontFaceCss(font){return"\n        @font-face {\n          font-family: '"+font.family+"';\n          src: url('"+font.url+"');\n          font-weight: "+font.weight+";\n          font-style: "+font.style+";\n        }\n      "}var customFontsUsed=(0,_lodash2.default)(nodes).filter(function(n){return"text"===n.type}).map(readFamilyAndVariant).filter(function(f){return null!==f}).uniqWith(_lodash2.default.isEqual).value(),customFontCss=customFontsUsed.map(function(font,i){return _react2.default.createElement("style",{key:i,dangerouslySetInnerHTML:{__html:getFontFaceCss(font)}})});return customFontCss}},{key:"render",value:function(){var _props=this.props,visitor=_props.visitor,nodes=_props.nodes,id=_props.id,extraProps=_objectWithoutProperties(_props,["visitor","nodes","id"]),canvas=nodes.find(function(n){return"canvas"===n.type}),responsiveNodes=CreativeNode.applyResponsiveness(nodes,extraProps.responsiveEnabled?this.state.width:canvas.width.value);return extraProps.animations=this.state.animations,extraProps.nodes=nodes,_react2.default.createElement("div",null,this.getGoogleFontCss(responsiveNodes),this.getCustomFontCss(responsiveNodes),(0,_creativeVisitor.visitCreative)(visitor,responsiveNodes,id,extraProps))}}]),CreativeReact}(_react2.default.Component);CreativeReact.propTypes={nodes:_react2.default.PropTypes.arrayOf(_react2.default.PropTypes.object).isRequired,id:_react2.default.PropTypes.number,visitor:_react2.default.PropTypes.object,animationsEnabled:_react2.default.PropTypes.bool,responsiveEnabled:_react2.default.PropTypes.bool,win:_react2.default.PropTypes.object},CreativeReact.defaultProps={visitor:new LinkedCreativeReactVisitor,animationsEnabled:!0}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./components/CreativeNode":12,"creative-visitor":22,"object-assign":21}],16:[function(require,module,exports){"use strict";function peg$subclass(child,parent){function ctor(){this.constructor=child}ctor.prototype=parent.prototype,child.prototype=new ctor}function peg$SyntaxError(message,expected,found,location){this.message=message,this.expected=expected,this.found=found,this.location=location,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,peg$SyntaxError)}function peg$parse(input,options){function peg$literalExpectation(text,ignoreCase){return{type:"literal",text:text,ignoreCase:ignoreCase}}function peg$classExpectation(parts,inverted,ignoreCase){return{type:"class",parts:parts,inverted:inverted,ignoreCase:ignoreCase}}function peg$anyExpectation(){return{type:"any"}}function peg$endExpectation(){return{type:"end"}}function peg$otherExpectation(description){return{type:"other",description:description}}function peg$computePosDetails(pos){var p,details=peg$posDetailsCache[pos];if(details)return details;for(p=pos-1;!peg$posDetailsCache[p];)p--;for(details=peg$posDetailsCache[p],details={line:details.line,column:details.column};p<pos;)10===input.charCodeAt(p)?(details.line++,details.column=1):details.column++,p++;return peg$posDetailsCache[pos]=details,details}function peg$computeLocation(startPos,endPos){var startPosDetails=peg$computePosDetails(startPos),endPosDetails=peg$computePosDetails(endPos);return{start:{offset:startPos,line:startPosDetails.line,column:startPosDetails.column},end:{offset:endPos,line:endPosDetails.line,column:endPosDetails.column}}}function peg$fail(expected){peg$currPos<peg$maxFailPos||(peg$currPos>peg$maxFailPos&&(peg$maxFailPos=peg$currPos,peg$maxFailExpected=[]),peg$maxFailExpected.push(expected))}function peg$buildStructuredError(expected,found,location){return new peg$SyntaxError(peg$SyntaxError.buildMessage(expected,found),expected,found,location)}function peg$parseStart(){var s0;return s0=peg$parseCreativePropertyExpression()}function peg$parseCreativePropertyExpression(){var s0,s1,s2,s3;if(s0=peg$currPos,s1=peg$parseStringLiteral(),s1!==peg$FAILED){for(s2=[],s3=peg$parseEmbeddedCodeFollowedByStringLiteral();s3!==peg$FAILED;)s2.push(s3),s3=peg$parseEmbeddedCodeFollowedByStringLiteral();s2!==peg$FAILED?(peg$savedPos=s0,s1=peg$c0(s1,s2),s0=s1):(peg$currPos=s0,s0=peg$FAILED)}else peg$currPos=s0,s0=peg$FAILED;return s0}function peg$parseStringLiteral(){var s0,s1,s2;for(s0=peg$currPos,s1=[],s2=peg$parseCharacterLiteral();s2!==peg$FAILED;)s1.push(s2),s2=peg$parseCharacterLiteral();return s1!==peg$FAILED&&(peg$savedPos=s0,s1=peg$c1(s1)),s0=s1}function peg$parseCharacterLiteral(){var s0,s1,s2;return s0=peg$currPos,s1=peg$currPos,peg$silentFails++,s2=peg$parseEmbeddedCode(),
peg$silentFails--,s2===peg$FAILED?s1=void 0:(peg$currPos=s1,s1=peg$FAILED),s1!==peg$FAILED?(input.length>peg$currPos?(s2=input.charAt(peg$currPos),peg$currPos++):(s2=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c2)),s2!==peg$FAILED?(peg$savedPos=s0,s1=peg$c3(s2),s0=s1):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED),s0}function peg$parseEmbeddedCodeFollowedByStringLiteral(){var s0,s1,s2;return s0=peg$currPos,s1=peg$parseEmbeddedCode(),s1!==peg$FAILED?(s2=peg$parseStringLiteral(),s2!==peg$FAILED?(peg$savedPos=s0,s1=peg$c4(s1,s2),s0=s1):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED),s0}function peg$parseEmbeddedCode(){var s0,s1,s2,s3;return s0=peg$currPos,input.substr(peg$currPos,2)===peg$c5?(s1=peg$c5,peg$currPos+=2):(s1=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c6)),s1!==peg$FAILED?(s2=peg$parseCode(),s2!==peg$FAILED?(input.substr(peg$currPos,2)===peg$c7?(s3=peg$c7,peg$currPos+=2):(s3=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c8)),s3!==peg$FAILED?(peg$savedPos=s0,s1=peg$c9(s2),s0=s1):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED),s0}function peg$parseCode(){var s0,s1,s2,s3;if(s0=peg$currPos,s1=peg$parseWhitespace(),s1!==peg$FAILED?(s2=peg$parseDoubleQuotedString(),s2!==peg$FAILED?(s3=peg$parseWhitespace(),s3!==peg$FAILED?(peg$savedPos=s0,s1=peg$c10(s2),s0=s1):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED),s0===peg$FAILED)if(s0=peg$currPos,s1=peg$parseWhitespace(),s1!==peg$FAILED){for(s2=[],s3=peg$parseAdditionFollowedByWhitespace();s3!==peg$FAILED;)s2.push(s3),s3=peg$parseAdditionFollowedByWhitespace();s2!==peg$FAILED?(peg$savedPos=s0,s1=peg$c11(s2),s0=s1):(peg$currPos=s0,s0=peg$FAILED)}else peg$currPos=s0,s0=peg$FAILED;return s0}function peg$parseWhitespace(){var s0,s1,s2;for(s0=peg$currPos,s1=[],32===input.charCodeAt(peg$currPos)?(s2=peg$c12,peg$currPos++):(s2=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c13));s2!==peg$FAILED;)s1.push(s2),32===input.charCodeAt(peg$currPos)?(s2=peg$c12,peg$currPos++):(s2=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c13));return s1!==peg$FAILED&&(peg$savedPos=s0,s1=peg$c14()),s0=s1}function peg$parseAdditionFollowedByWhitespace(){var s0,s1,s2;return s0=peg$currPos,s1=peg$parseAddition(),s1!==peg$FAILED?(s2=peg$parseWhitespace(),s2!==peg$FAILED?(peg$savedPos=s0,s1=peg$c15(s1),s0=s1):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED),s0}function peg$parseAddition(){var s0,s1,s2,s3,s4,s5;return s0=peg$currPos,s1=peg$parseDataRef(),s1!==peg$FAILED?(s2=peg$parseWhitespace(),s2!==peg$FAILED?(peg$c16.test(input.charAt(peg$currPos))?(s3=input.charAt(peg$currPos),peg$currPos++):(s3=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c17)),s3!==peg$FAILED?(s4=peg$parseWhitespace(),s4!==peg$FAILED?(s5=peg$parseAddition(),s5!==peg$FAILED?(peg$savedPos=s0,s1=peg$c18(s1,s3,s5),s0=s1):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED),s0===peg$FAILED&&(s0=peg$parseMultiplication()),s0}function peg$parseMultiplication(){var s0,s1,s2,s3,s4,s5;return s0=peg$currPos,s1=peg$parseDataRef(),s1!==peg$FAILED?(s2=peg$parseWhitespace(),s2!==peg$FAILED?(peg$c19.test(input.charAt(peg$currPos))?(s3=input.charAt(peg$currPos),peg$currPos++):(s3=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c20)),s3!==peg$FAILED?(s4=peg$parseWhitespace(),s4!==peg$FAILED?(s5=peg$parseMultiplication(),s5!==peg$FAILED?(peg$savedPos=s0,s1=peg$c18(s1,s3,s5),s0=s1):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED),s0===peg$FAILED&&(s0=peg$parseDataRef()),s0}function peg$parseDataRef(){var s0,s1,s2,s3,s4,s5;return s0=peg$currPos,s1=peg$parseIdentifier(),s1!==peg$FAILED?(91===input.charCodeAt(peg$currPos)?(s2=peg$c21,peg$currPos++):(s2=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c22)),s2!==peg$FAILED?(s3=peg$parseDataRefRank(),s3!==peg$FAILED?(input.substr(peg$currPos,2)===peg$c23?(s4=peg$c23,peg$currPos+=2):(s4=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c24)),s4!==peg$FAILED?(s5=peg$parseIdentifier(),s5!==peg$FAILED?(peg$savedPos=s0,s1=peg$c25(s1,s3,s5),s0=s1):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED),s0===peg$FAILED&&(s0=peg$parseOperand()),s0}function peg$parseIdentifier(){var s0,s1,s2,s3;if(s0=peg$currPos,peg$c26.test(input.charAt(peg$currPos))?(s1=input.charAt(peg$currPos),peg$currPos++):(s1=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c27)),s1!==peg$FAILED){for(s2=[],peg$c28.test(input.charAt(peg$currPos))?(s3=input.charAt(peg$currPos),peg$currPos++):(s3=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c29));s3!==peg$FAILED;)s2.push(s3),peg$c28.test(input.charAt(peg$currPos))?(s3=input.charAt(peg$currPos),peg$currPos++):(s3=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c29));s2!==peg$FAILED?(peg$savedPos=s0,s1=peg$c30(s1,s2),s0=s1):(peg$currPos=s0,s0=peg$FAILED)}else peg$currPos=s0,s0=peg$FAILED;return s0}function peg$parseDataRefRank(){var s0,s1,s2,s3;if(s0=peg$currPos,peg$c31.test(input.charAt(peg$currPos))?(s1=input.charAt(peg$currPos),peg$currPos++):(s1=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c32)),s1!==peg$FAILED){for(s2=[],peg$c33.test(input.charAt(peg$currPos))?(s3=input.charAt(peg$currPos),peg$currPos++):(s3=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c34));s3!==peg$FAILED;)s2.push(s3),peg$c33.test(input.charAt(peg$currPos))?(s3=input.charAt(peg$currPos),peg$currPos++):(s3=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c34));s2!==peg$FAILED?(peg$savedPos=s0,s1=peg$c35(s1,s2),s0=s1):(peg$currPos=s0,s0=peg$FAILED)}else peg$currPos=s0,s0=peg$FAILED;return s0}function peg$parseOperand(){var s0,s1,s2,s3,s4,s5;return s0=peg$parseIntegerLiteral(),s0===peg$FAILED&&(s0=peg$currPos,40===input.charCodeAt(peg$currPos)?(s1=peg$c36,peg$currPos++):(s1=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c37)),s1!==peg$FAILED?(s2=peg$parseWhitespace(),s2!==peg$FAILED?(s3=peg$parseAddition(),s3!==peg$FAILED?(s4=peg$parseWhitespace(),s4!==peg$FAILED?(41===input.charCodeAt(peg$currPos)?(s5=peg$c38,peg$currPos++):(s5=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c39)),s5!==peg$FAILED?(peg$savedPos=s0,s1=peg$c40(s3),s0=s1):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED)),s0}function peg$parseIntegerLiteral(){var s0,s1,s2,s3,s4;if(s0=peg$currPos,peg$c16.test(input.charAt(peg$currPos))?(s1=input.charAt(peg$currPos),peg$currPos++):(s1=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c17)),s1===peg$FAILED&&(s1=null),s1!==peg$FAILED)if(peg$c31.test(input.charAt(peg$currPos))?(s2=input.charAt(peg$currPos),peg$currPos++):(s2=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c32)),s2!==peg$FAILED){for(s3=[],peg$c33.test(input.charAt(peg$currPos))?(s4=input.charAt(peg$currPos),peg$currPos++):(s4=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c34));s4!==peg$FAILED;)s3.push(s4),peg$c33.test(input.charAt(peg$currPos))?(s4=input.charAt(peg$currPos),peg$currPos++):(s4=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c34));s3!==peg$FAILED?(peg$savedPos=s0,s1=peg$c41(s1,s2,s3),s0=s1):(peg$currPos=s0,s0=peg$FAILED)}else peg$currPos=s0,s0=peg$FAILED;else peg$currPos=s0,s0=peg$FAILED;return s0===peg$FAILED&&(s0=peg$currPos,peg$c42.test(input.charAt(peg$currPos))?(s1=input.charAt(peg$currPos),peg$currPos++):(s1=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c43)),s1!==peg$FAILED&&(peg$savedPos=s0,s1=peg$c44()),s0=s1),s0}function peg$parseDoubleQuotedString(){var s0,s1,s2,s3;if(s0=peg$currPos,34===input.charCodeAt(peg$currPos)?(s1=peg$c45,peg$currPos++):(s1=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c46)),s1!==peg$FAILED){for(s2=[],s3=peg$parseDoubleQuotedCharacter();s3!==peg$FAILED;)s2.push(s3),s3=peg$parseDoubleQuotedCharacter();s2!==peg$FAILED?(34===input.charCodeAt(peg$currPos)?(s3=peg$c45,peg$currPos++):(s3=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c46)),s3!==peg$FAILED?(peg$savedPos=s0,s1=peg$c1(s2),s0=s1):(peg$currPos=s0,s0=peg$FAILED)):(peg$currPos=s0,s0=peg$FAILED)}else peg$currPos=s0,s0=peg$FAILED;return s0}function peg$parseDoubleQuotedCharacter(){var s0,s1;return s0=peg$currPos,input.substr(peg$currPos,2)===peg$c47?(s1=peg$c47,peg$currPos+=2):(s1=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c48)),s1!==peg$FAILED&&(peg$savedPos=s0,s1=peg$c49()),s0=s1,s0===peg$FAILED&&(s0=peg$currPos,input.substr(peg$currPos,2)===peg$c50?(s1=peg$c50,peg$currPos+=2):(s1=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c51)),s1!==peg$FAILED&&(peg$savedPos=s0,s1=peg$c52()),s0=s1,s0===peg$FAILED&&(peg$c53.test(input.charAt(peg$currPos))?(s0=input.charAt(peg$currPos),peg$currPos++):(s0=peg$FAILED,0===peg$silentFails&&peg$fail(peg$c54)))),s0}function normalize(ast){if(Array.isArray(ast)){var flattenedAst=ast.filter(function(e){return""!==e}).reduce(function(a,e){return a.concat(e)},[]);return 0===flattenedAst.length?"":1===flattenedAst.length?flattenedAst[0]:flattenedAst}return ast}options=void 0!==options?options:{};var peg$result,peg$FAILED={},peg$startRuleFunctions={Start:peg$parseStart},peg$startRuleFunction=peg$parseStart,peg$c0=function(first,rest){return normalize([first].concat(normalize(rest)))},peg$c1=function(chars){return chars.join("")},peg$c2=peg$anyExpectation(),peg$c3=function(char){return char},peg$c4=function(first,second){return normalize([first,second])},peg$c5="{{",peg$c6=peg$literalExpectation("{{",!1),peg$c7="}}",peg$c8=peg$literalExpectation("}}",!1),peg$c9=function(code){return code},peg$c10=function(string){return string},peg$c11=function(code){return normalize(code)},peg$c12=" ",peg$c13=peg$literalExpectation(" ",!1),peg$c14=function(){return""},peg$c15=function(first){return first},peg$c16=/^[+\-]/,peg$c17=peg$classExpectation(["+","-"],!1,!1),peg$c18=function(left,operator,right){return{type:operator,left:left,right:right}},peg$c19=/^[*\/]/,peg$c20=peg$classExpectation(["*","/"],!1,!1),peg$c21="[",peg$c22=peg$literalExpectation("[",!1),peg$c23="].",peg$c24=peg$literalExpectation("].",!1),peg$c25=function(query,rank,field){return{type:"ref",name:query,rank:rank,field:field}},peg$c26=/^[_a-zA-Z]/,peg$c27=peg$classExpectation(["_",["a","z"],["A","Z"]],!1,!1),peg$c28=/^[_a-zA-Z0-9]/,peg$c29=peg$classExpectation(["_",["a","z"],["A","Z"],["0","9"]],!1,!1),peg$c30=function(first,rest){return[first].concat(rest).join("")},peg$c31=/^[1-9]/,peg$c32=peg$classExpectation([["1","9"]],!1,!1),peg$c33=/^[0-9]/,peg$c34=peg$classExpectation([["0","9"]],!1,!1),peg$c35=function(first,rest){return parseInt([first].concat(rest).join(""))},peg$c36="(",peg$c37=peg$literalExpectation("(",!1),peg$c38=")",peg$c39=peg$literalExpectation(")",!1),peg$c40=function(expr){return expr},peg$c41=function(sign,first,rest){var unsignedInt=parseInt([first].concat(rest).join(""));return"-"===sign?-unsignedInt:unsignedInt},peg$c42=/^[0]/,peg$c43=peg$classExpectation(["0"],!1,!1),peg$c44=function(){return 0},peg$c45='"',peg$c46=peg$literalExpectation('"',!1),peg$c47="\\\\",peg$c48=peg$literalExpectation("\\\\",!1),peg$c49=function(){return"\\"},peg$c50='\\"',peg$c51=peg$literalExpectation('\\"',!1),peg$c52=function(){return'"'},peg$c53=/^[^"]/,peg$c54=peg$classExpectation(['"'],!0,!1),peg$currPos=0,peg$savedPos=0,peg$posDetailsCache=[{line:1,column:1}],peg$maxFailPos=0,peg$maxFailExpected=[],peg$silentFails=0;if("startRule"in options){if(!(options.startRule in peg$startRuleFunctions))throw new Error("Can't start parsing from rule \""+options.startRule+'".');peg$startRuleFunction=peg$startRuleFunctions[options.startRule]}if(peg$result=peg$startRuleFunction(),peg$result!==peg$FAILED&&peg$currPos===input.length)return peg$result;throw peg$result!==peg$FAILED&&peg$currPos<input.length&&peg$fail(peg$endExpectation()),peg$buildStructuredError(peg$maxFailExpected,peg$maxFailPos<input.length?input.charAt(peg$maxFailPos):null,peg$maxFailPos<input.length?peg$computeLocation(peg$maxFailPos,peg$maxFailPos+1):peg$computeLocation(peg$maxFailPos,peg$maxFailPos))}peg$subclass(peg$SyntaxError,Error),peg$SyntaxError.buildMessage=function(expected,found){function hex(ch){return ch.charCodeAt(0).toString(16).toUpperCase()}function literalEscape(s){return s.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(ch){return"\\x0"+hex(ch)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(ch){return"\\x"+hex(ch)})}function classEscape(s){return s.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(ch){return"\\x0"+hex(ch)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(ch){return"\\x"+hex(ch)})}function describeExpectation(expectation){return DESCRIBE_EXPECTATION_FNS[expectation.type](expectation)}function describeExpected(expected){var i,j,descriptions=new Array(expected.length);for(i=0;i<expected.length;i++)descriptions[i]=describeExpectation(expected[i]);if(descriptions.sort(),descriptions.length>0){for(i=1,j=1;i<descriptions.length;i++)descriptions[i-1]!==descriptions[i]&&(descriptions[j]=descriptions[i],j++);descriptions.length=j}switch(descriptions.length){case 1:return descriptions[0];case 2:return descriptions[0]+" or "+descriptions[1];default:return descriptions.slice(0,-1).join(", ")+", or "+descriptions[descriptions.length-1]}}function describeFound(found){return found?'"'+literalEscape(found)+'"':"end of input"}var DESCRIBE_EXPECTATION_FNS={literal:function(expectation){return'"'+literalEscape(expectation.text)+'"'},class:function(expectation){var i,escapedParts="";for(i=0;i<expectation.parts.length;i++)escapedParts+=expectation.parts[i]instanceof Array?classEscape(expectation.parts[i][0])+"-"+classEscape(expectation.parts[i][1]):classEscape(expectation.parts[i]);return"["+(expectation.inverted?"^":"")+escapedParts+"]"},any:function(expectation){return"any character"},end:function(expectation){return"end of input"},other:function(expectation){return expectation.description}};return"Expected "+describeExpected(expected)+" but "+describeFound(found)+" found."},module.exports={SyntaxError:peg$SyntaxError,parse:peg$parse}},{}],17:[function(require,module,exports){"use strict";function queriesObjectReader(queries,name,rank,field){if(!Object.prototype.hasOwnProperty.call(queries,name))return"";var items=queries[name];if(rank-1>=items.length)return"";var item=queries[name][rank-1];return Object.prototype.hasOwnProperty.call(item,field)?item[field]:""}function resolveQuery(env){return function(name,rank,field){if(!env||!env.queries)return"";var reader="function"==typeof env.queries?env.queries:queriesObjectReader.bind(null,env.queries),value=reader(name,rank,field);return["number","string"].indexOf("undefined"==typeof value?"undefined":_typeof(value))===-1?"":value}}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj};module.exports={query:resolveQuery}},{}],18:[function(require,module,exports){"use strict";function evaluateAST(ast,env){function recurse(ast){return evaluateAST(ast,env)}if("string"==typeof ast)return ast;if("number"==typeof ast)return ast;if(Array.isArray(ast))return ast.reduce(function(a,e){return[a].concat(recurse(e)).join("")},"");if("object"===("undefined"==typeof ast?"undefined":_typeof(ast)))switch(ast.type){case"ref":if("string"!=typeof ast.name||!Number.isInteger(ast.rank)||ast.rank-1<0||"string"!=typeof ast.field)throw new Error("Could not evaluate invalid AST: "+JSON.stringify(ast));return environment.query(env)(ast.name,ast.rank,ast.field);case"+":return Number(recurse(ast.left))+Number(recurse(ast.right));case"-":return recurse(ast.left)-recurse(ast.right);case"*":return recurse(ast.left)*recurse(ast.right);case"/":return recurse(ast.left)/recurse(ast.right)}throw new Error("Could not evaluate unrecognized AST: "+JSON.stringify(ast))}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj},environment=require("./environment");module.exports=function(parse){return{fromString:function(string,env){return evaluateAST(parse(string),env)},fromAST:evaluateAST}}},{"./environment":17}],19:[function(require,module,exports){"use strict";var cpe=require("./cpe"),evaluate=require("./evaluate");module.exports={parse:cpe.parse,evaluate:evaluate(cpe.parse)}},{"./cpe":16,"./evaluate":18}],20:[function(require,module,exports){(function(process){"use strict";var invariant=function(condition,format,a,b,c,d,e,f){if("production"!==process.env.NODE_ENV&&void 0===format)throw new Error("invariant requires an error message argument");if(!condition){var error;if(void 0===format)error=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var args=[a,b,c,d,e,f],argIndex=0;error=new Error(format.replace(/%s/g,function(){return args[argIndex++]})),error.name="Invariant Violation"}throw error.framesToPop=1,error}};module.exports=invariant}).call(this,require("_process"))},{_process:26}],21:[function(require,module,exports){"use strict";function toObject(val){if(null===val||void 0===val)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(val)}function shouldUseNative(){try{if(!Object.assign)return!1;var test1=new String("abc");if(test1[5]="de","5"===Object.getOwnPropertyNames(test1)[0])return!1;for(var test2={},i=0;i<10;i++)test2["_"+String.fromCharCode(i)]=i;var order2=Object.getOwnPropertyNames(test2).map(function(n){return test2[n]});if("0123456789"!==order2.join(""))return!1;var test3={};return"abcdefghijklmnopqrst".split("").forEach(function(letter){test3[letter]=letter}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},test3)).join("")}catch(err){return!1}}var getOwnPropertySymbols=Object.getOwnPropertySymbols,hasOwnProperty=Object.prototype.hasOwnProperty,propIsEnumerable=Object.prototype.propertyIsEnumerable;module.exports=shouldUseNative()?Object.assign:function(target,source){for(var from,symbols,to=toObject(target),s=1;s<arguments.length;s++){from=Object(arguments[s]);for(var key in from)hasOwnProperty.call(from,key)&&(to[key]=from[key]);if(getOwnPropertySymbols){symbols=getOwnPropertySymbols(from);for(var i=0;i<symbols.length;i++)propIsEnumerable.call(from,symbols[i])&&(to[symbols[i]]=from[symbols[i]])}}return to}},{}],22:[function(require,module,exports){!function(root,factory){"object"==typeof exports&&"object"==typeof module?module.exports=factory():"function"==typeof define&&define.amd?define([],factory):"object"==typeof exports?exports.creativeVisitor=factory():root.creativeVisitor=factory()}(this,function(){return function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports){"use strict";function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function find(array,predicate){for(var i=0;i<array.length;i++){var value=array[i];if(predicate(value,i,array))return value}}function findRootNode(nodes){return find(nodes,function(n){return"canvas"===n.type})}function findNodeById(nodes,id){return find(nodes,function(n){return n.id===id})}function visitCreativeById(visitor,nodes,id){for(var _len=arguments.length,params=Array(_len>3?_len-3:0),_key=3;_key<_len;_key++)params[_key-3]=arguments[_key];var creative=void 0===id?findRootNode(nodes):findNodeById(nodes,id);if(void 0!==creative){var doEnter=visitor.enter.apply(visitor,[creative].concat(params));if(doEnter!==!1){var childResults=void 0===creative.children?void 0:creative.children.map(function(childId){return visitCreativeById.apply(void 0,[visitor,nodes,childId].concat(params))}).filter(function(result){return void 0!==result});return visitor.exit.apply(visitor,[creative,childResults].concat(params))}}}function capitalize(str){return str.length>0?str.charAt(0).toUpperCase()+str.slice(1):str}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),CreativeVisitor=(exports.visitCreative=visitCreativeById,exports.CreativeVisitor=function(){function CreativeVisitor(){_classCallCheck(this,CreativeVisitor)}return _createClass(CreativeVisitor,[{key:"getType",value:function(node){return node.type}},{key:"enter",value:function(node){for(var _len2=arguments.length,extraParams=Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++)extraParams[_key2-1]=arguments[_key2];return this._actOnType("enter",this.getType(node),[node].concat(extraParams),!1)}},{key:"exit",value:function(node,children){for(var _len3=arguments.length,extraParams=Array(_len3>2?_len3-2:0),_key3=2;_key3<_len3;_key3++)extraParams[_key3-2]=arguments[_key3];return this._actOnType("exit",this.getType(node),[node,children].concat(extraParams))}},{key:"_hasActionOnType",value:function(action,nodeType){return nodeType&&void 0!==this[action+capitalize(nodeType)]||void 0!==this[action+"Any"]}},{key:"_actOnType",value:function(action,nodeType,params){var missingReturn=arguments.length<=3||void 0===arguments[3]?void 0:arguments[3],actionByType=void 0;if(nodeType&&(actionByType=this[action+capitalize(nodeType)]),void 0===actionByType&&(actionByType=this[action+"Any"]),void 0!==actionByType){var _actionByType;return(_actionByType=actionByType).call.apply(_actionByType,[this].concat(_toConsumableArray(params)))}return missingReturn}}]),CreativeVisitor}());exports.CreativeBuilderVisitor=function(_CreativeVisitor){function CreativeBuilderVisitor(){return _classCallCheck(this,CreativeBuilderVisitor),_possibleConstructorReturn(this,Object.getPrototypeOf(CreativeBuilderVisitor).apply(this,arguments))}return _inherits(CreativeBuilderVisitor,_CreativeVisitor),_createClass(CreativeBuilderVisitor,[{key:"enter",value:function(node){return this._hasActionOnType("build",this.getType(node))}},{key:"exit",value:function(node,children){for(var _len4=arguments.length,extraParams=Array(_len4>2?_len4-2:0),_key4=2;_key4<_len4;_key4++)extraParams[_key4-2]=arguments[_key4];return this.build.apply(this,[node,children].concat(extraParams))}},{key:"build",value:function(node){for(var _len5=arguments.length,params=Array(_len5>1?_len5-1:0),_key5=1;_key5<_len5;_key5++)params[_key5-1]=arguments[_key5];return this._actOnType("build",this.getType(node),[node].concat(params))}}]),CreativeBuilderVisitor}(CreativeVisitor)}])})},{}],23:[function(require,module,exports){"use strict";function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function urlParse(url,parseQueryString,slashesDenoteHost){if(url&&util.isObject(url)&&url instanceof Url)return url;var u=new Url;return u.parse(url,parseQueryString,slashesDenoteHost),u}function urlFormat(obj){return util.isString(obj)&&(obj=urlParse(obj)),obj instanceof Url?obj.format():Url.prototype.format.call(obj)}function urlResolve(source,relative){return urlParse(source,!1,!0).resolve(relative)}function urlResolveObject(source,relative){return source?urlParse(source,!1,!0).resolveObject(relative):relative}var punycode=require("punycode"),util=require("./util");exports.parse=urlParse,exports.resolve=urlResolve,exports.resolveObject=urlResolveObject,exports.format=urlFormat,exports.Url=Url;var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,delims=["<",">",'"',"`"," ","\r","\n","\t"],unwise=["{","}","|","\\","^","`"].concat(delims),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnameMaxLen=255,hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},querystring=require("querystring");Url.prototype.parse=function(url,parseQueryString,slashesDenoteHost){if(!util.isString(url))throw new TypeError("Parameter 'url' must be a string, not "+typeof url);var queryIndex=url.indexOf("?"),splitter=queryIndex!==-1&&queryIndex<url.indexOf("#")?"?":"#",uSplit=url.split(splitter),slashRegex=/\\/g;uSplit[0]=uSplit[0].replace(slashRegex,"/"),url=uSplit.join(splitter);var rest=url;if(rest=rest.trim(),!slashesDenoteHost&&1===url.split("#").length){var simplePath=simplePathPattern.exec(rest);if(simplePath)return this.path=rest,this.href=rest,this.pathname=simplePath[1],simplePath[2]?(this.search=simplePath[2],parseQueryString?this.query=querystring.parse(this.search.substr(1)):this.query=this.search.substr(1)):parseQueryString&&(this.search="",this.query={}),this}var proto=protocolPattern.exec(rest);if(proto){proto=proto[0];var lowerProto=proto.toLowerCase();this.protocol=lowerProto,rest=rest.substr(proto.length)}if(slashesDenoteHost||proto||rest.match(/^\/\/[^@\/]+@[^@\/]+/)){var slashes="//"===rest.substr(0,2);!slashes||proto&&hostlessProtocol[proto]||(rest=rest.substr(2),this.slashes=!0)}if(!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){for(var hostEnd=-1,i=0;i<hostEndingChars.length;i++){var hec=rest.indexOf(hostEndingChars[i]);hec!==-1&&(hostEnd===-1||hec<hostEnd)&&(hostEnd=hec)}var auth,atSign;atSign=hostEnd===-1?rest.lastIndexOf("@"):rest.lastIndexOf("@",hostEnd),atSign!==-1&&(auth=rest.slice(0,atSign),rest=rest.slice(atSign+1),this.auth=decodeURIComponent(auth)),hostEnd=-1;for(var i=0;i<nonHostChars.length;i++){var hec=rest.indexOf(nonHostChars[i]);hec!==-1&&(hostEnd===-1||hec<hostEnd)&&(hostEnd=hec)}hostEnd===-1&&(hostEnd=rest.length),this.host=rest.slice(0,hostEnd),rest=rest.slice(hostEnd),this.parseHost(),this.hostname=this.hostname||"";var ipv6Hostname="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!ipv6Hostname)for(var hostparts=this.hostname.split(/\./),i=0,l=hostparts.length;i<l;i++){var part=hostparts[i];if(part&&!part.match(hostnamePartPattern)){for(var newpart="",j=0,k=part.length;j<k;j++)newpart+=part.charCodeAt(j)>127?"x":part[j];if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,i),notHost=hostparts.slice(i+1),bit=part.match(hostnamePartStart);bit&&(validParts.push(bit[1]),notHost.unshift(bit[2])),notHost.length&&(rest="/"+notHost.join(".")+rest),this.hostname=validParts.join(".");break}}}this.hostname.length>hostnameMaxLen?this.hostname="":this.hostname=this.hostname.toLowerCase(),ipv6Hostname||(this.hostname=punycode.toASCII(this.hostname));var p=this.port?":"+this.port:"",h=this.hostname||"";this.host=h+p,this.href+=this.host,ipv6Hostname&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==rest[0]&&(rest="/"+rest))}if(!unsafeProtocol[lowerProto])for(var i=0,l=autoEscape.length;i<l;i++){var ae=autoEscape[i];if(rest.indexOf(ae)!==-1){var esc=encodeURIComponent(ae);esc===ae&&(esc=escape(ae)),rest=rest.split(ae).join(esc)}}var hash=rest.indexOf("#");hash!==-1&&(this.hash=rest.substr(hash),rest=rest.slice(0,hash));var qm=rest.indexOf("?");if(qm!==-1?(this.search=rest.substr(qm),this.query=rest.substr(qm+1),parseQueryString&&(this.query=querystring.parse(this.query)),rest=rest.slice(0,qm)):parseQueryString&&(this.search="",this.query={}),rest&&(this.pathname=rest),slashedProtocol[lowerProto]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var p=this.pathname||"",s=this.search||"";this.path=p+s}return this.href=this.format(),this},Url.prototype.format=function(){var auth=this.auth||"";auth&&(auth=encodeURIComponent(auth),auth=auth.replace(/%3A/i,":"),auth+="@");var protocol=this.protocol||"",pathname=this.pathname||"",hash=this.hash||"",host=!1,query="";this.host?host=auth+this.host:this.hostname&&(host=auth+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(host+=":"+this.port)),this.query&&util.isObject(this.query)&&Object.keys(this.query).length&&(query=querystring.stringify(this.query));var search=this.search||query&&"?"+query||"";return protocol&&":"!==protocol.substr(-1)&&(protocol+=":"),this.slashes||(!protocol||slashedProtocol[protocol])&&host!==!1?(host="//"+(host||""),pathname&&"/"!==pathname.charAt(0)&&(pathname="/"+pathname)):host||(host=""),hash&&"#"!==hash.charAt(0)&&(hash="#"+hash),search&&"?"!==search.charAt(0)&&(search="?"+search),pathname=pathname.replace(/[?#]/g,function(match){return encodeURIComponent(match)}),search=search.replace("#","%23"),protocol+host+pathname+search+hash},Url.prototype.resolve=function(relative){return this.resolveObject(urlParse(relative,!1,!0)).format()},Url.prototype.resolveObject=function(relative){if(util.isString(relative)){var rel=new Url;rel.parse(relative,!1,!0),relative=rel}for(var result=new Url,tkeys=Object.keys(this),tk=0;tk<tkeys.length;tk++){var tkey=tkeys[tk];result[tkey]=this[tkey]}if(result.hash=relative.hash,""===relative.href)return result.href=result.format(),result;if(relative.slashes&&!relative.protocol){for(var rkeys=Object.keys(relative),rk=0;rk<rkeys.length;rk++){var rkey=rkeys[rk];"protocol"!==rkey&&(result[rkey]=relative[rkey])}return slashedProtocol[result.protocol]&&result.hostname&&!result.pathname&&(result.path=result.pathname="/"),result.href=result.format(),result}if(relative.protocol&&relative.protocol!==result.protocol){if(!slashedProtocol[relative.protocol]){for(var keys=Object.keys(relative),v=0;v<keys.length;v++){var k=keys[v];result[k]=relative[k]}return result.href=result.format(),result}if(result.protocol=relative.protocol,relative.host||hostlessProtocol[relative.protocol])result.pathname=relative.pathname;else{for(var relPath=(relative.pathname||"").split("/");relPath.length&&!(relative.host=relPath.shift()););relative.host||(relative.host=""),relative.hostname||(relative.hostname=""),""!==relPath[0]&&relPath.unshift(""),
relPath.length<2&&relPath.unshift(""),result.pathname=relPath.join("/")}if(result.search=relative.search,result.query=relative.query,result.host=relative.host||"",result.auth=relative.auth,result.hostname=relative.hostname||relative.host,result.port=relative.port,result.pathname||result.search){var p=result.pathname||"",s=result.search||"";result.path=p+s}return result.slashes=result.slashes||relative.slashes,result.href=result.format(),result}var isSourceAbs=result.pathname&&"/"===result.pathname.charAt(0),isRelAbs=relative.host||relative.pathname&&"/"===relative.pathname.charAt(0),mustEndAbs=isRelAbs||isSourceAbs||result.host&&relative.pathname,removeAllDots=mustEndAbs,srcPath=result.pathname&&result.pathname.split("/")||[],relPath=relative.pathname&&relative.pathname.split("/")||[],psychotic=result.protocol&&!slashedProtocol[result.protocol];if(psychotic&&(result.hostname="",result.port=null,result.host&&(""===srcPath[0]?srcPath[0]=result.host:srcPath.unshift(result.host)),result.host="",relative.protocol&&(relative.hostname=null,relative.port=null,relative.host&&(""===relPath[0]?relPath[0]=relative.host:relPath.unshift(relative.host)),relative.host=null),mustEndAbs=mustEndAbs&&(""===relPath[0]||""===srcPath[0])),isRelAbs)result.host=relative.host||""===relative.host?relative.host:result.host,result.hostname=relative.hostname||""===relative.hostname?relative.hostname:result.hostname,result.search=relative.search,result.query=relative.query,srcPath=relPath;else if(relPath.length)srcPath||(srcPath=[]),srcPath.pop(),srcPath=srcPath.concat(relPath),result.search=relative.search,result.query=relative.query;else if(!util.isNullOrUndefined(relative.search)){if(psychotic){result.hostname=result.host=srcPath.shift();var authInHost=!!(result.host&&result.host.indexOf("@")>0)&&result.host.split("@");authInHost&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift())}return result.search=relative.search,result.query=relative.query,util.isNull(result.pathname)&&util.isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.href=result.format(),result}if(!srcPath.length)return result.pathname=null,result.search?result.path="/"+result.search:result.path=null,result.href=result.format(),result;for(var last=srcPath.slice(-1)[0],hasTrailingSlash=(result.host||relative.host||srcPath.length>1)&&("."===last||".."===last)||""===last,up=0,i=srcPath.length;i>=0;i--)last=srcPath[i],"."===last?srcPath.splice(i,1):".."===last?(srcPath.splice(i,1),up++):up&&(srcPath.splice(i,1),up--);if(!mustEndAbs&&!removeAllDots)for(;up--;up)srcPath.unshift("..");!mustEndAbs||""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0)||srcPath.unshift(""),hasTrailingSlash&&"/"!==srcPath.join("/").substr(-1)&&srcPath.push("");var isAbsolute=""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0);if(psychotic){result.hostname=result.host=isAbsolute?"":srcPath.length?srcPath.shift():"";var authInHost=!!(result.host&&result.host.indexOf("@")>0)&&result.host.split("@");authInHost&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift())}return mustEndAbs=mustEndAbs||result.host&&srcPath.length,mustEndAbs&&!isAbsolute&&srcPath.unshift(""),srcPath.length?result.pathname=srcPath.join("/"):(result.pathname=null,result.path=null),util.isNull(result.pathname)&&util.isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.auth=relative.auth||result.auth,result.slashes=result.slashes||relative.slashes,result.href=result.format(),result},Url.prototype.parseHost=function(){var host=this.host,port=portPattern.exec(host);port&&(port=port[0],":"!==port&&(this.port=port.substr(1)),host=host.substr(0,host.length-port.length)),host&&(this.hostname=host)}},{"./util":24,punycode:27,querystring:30}],24:[function(require,module,exports){"use strict";module.exports={isString:function(arg){return"string"==typeof arg},isObject:function(arg){return"object"==typeof arg&&null!==arg},isNull:function(arg){return null===arg},isNullOrUndefined:function(arg){return null==arg}}},{}],25:[function(require,module,exports){arguments[4][21][0].apply(exports,arguments)},{dup:21}],26:[function(require,module,exports){function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=cachedSetTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,cachedClearTimeout(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}var cachedSetTimeout,cachedClearTimeout,process=module.exports={};!function(){try{cachedSetTimeout=setTimeout}catch(e){cachedSetTimeout=function(){throw new Error("setTimeout is not defined")}}try{cachedClearTimeout=clearTimeout}catch(e){cachedClearTimeout=function(){throw new Error("clearTimeout is not defined")}}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||cachedSetTimeout(drainQueue,0)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],27:[function(require,module,exports){(function(global){!function(root){function error(type){throw new RangeError(errors[type])}function map(array,fn){for(var length=array.length,result=[];length--;)result[length]=fn(array[length]);return result}function mapDomain(string,fn){var parts=string.split("@"),result="";parts.length>1&&(result=parts[0]+"@",string=parts[1]),string=string.replace(regexSeparators,".");var labels=string.split("."),encoded=map(labels,fn).join(".");return result+encoded}function ucs2decode(string){for(var value,extra,output=[],counter=0,length=string.length;counter<length;)value=string.charCodeAt(counter++),value>=55296&&value<=56319&&counter<length?(extra=string.charCodeAt(counter++),56320==(64512&extra)?output.push(((1023&value)<<10)+(1023&extra)+65536):(output.push(value),counter--)):output.push(value);return output}function ucs2encode(array){return map(array,function(value){var output="";return value>65535&&(value-=65536,output+=stringFromCharCode(value>>>10&1023|55296),value=56320|1023&value),output+=stringFromCharCode(value)}).join("")}function basicToDigit(codePoint){return codePoint-48<10?codePoint-22:codePoint-65<26?codePoint-65:codePoint-97<26?codePoint-97:base}function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((0!=flag)<<5)}function adapt(delta,numPoints,firstTime){var k=0;for(delta=firstTime?floor(delta/damp):delta>>1,delta+=floor(delta/numPoints);delta>baseMinusTMin*tMax>>1;k+=base)delta=floor(delta/baseMinusTMin);return floor(k+(baseMinusTMin+1)*delta/(delta+skew))}function decode(input){var out,basic,j,index,oldi,w,k,digit,t,baseMinusT,output=[],inputLength=input.length,i=0,n=initialN,bias=initialBias;for(basic=input.lastIndexOf(delimiter),basic<0&&(basic=0),j=0;j<basic;++j)input.charCodeAt(j)>=128&&error("not-basic"),output.push(input.charCodeAt(j));for(index=basic>0?basic+1:0;index<inputLength;){for(oldi=i,w=1,k=base;index>=inputLength&&error("invalid-input"),digit=basicToDigit(input.charCodeAt(index++)),(digit>=base||digit>floor((maxInt-i)/w))&&error("overflow"),i+=digit*w,t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias,!(digit<t);k+=base)baseMinusT=base-t,w>floor(maxInt/baseMinusT)&&error("overflow"),w*=baseMinusT;out=output.length+1,bias=adapt(i-oldi,out,0==oldi),floor(i/out)>maxInt-n&&error("overflow"),n+=floor(i/out),i%=out,output.splice(i++,0,n)}return ucs2encode(output)}function encode(input){var n,delta,handledCPCount,basicLength,bias,j,m,q,k,t,currentValue,inputLength,handledCPCountPlusOne,baseMinusT,qMinusT,output=[];for(input=ucs2decode(input),inputLength=input.length,n=initialN,delta=0,bias=initialBias,j=0;j<inputLength;++j)currentValue=input[j],currentValue<128&&output.push(stringFromCharCode(currentValue));for(handledCPCount=basicLength=output.length,basicLength&&output.push(delimiter);handledCPCount<inputLength;){for(m=maxInt,j=0;j<inputLength;++j)currentValue=input[j],currentValue>=n&&currentValue<m&&(m=currentValue);for(handledCPCountPlusOne=handledCPCount+1,m-n>floor((maxInt-delta)/handledCPCountPlusOne)&&error("overflow"),delta+=(m-n)*handledCPCountPlusOne,n=m,j=0;j<inputLength;++j)if(currentValue=input[j],currentValue<n&&++delta>maxInt&&error("overflow"),currentValue==n){for(q=delta,k=base;t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias,!(q<t);k+=base)qMinusT=q-t,baseMinusT=base-t,output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0))),q=floor(qMinusT/baseMinusT);output.push(stringFromCharCode(digitToBasic(q,0))),bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength),delta=0,++handledCPCount}++delta,++n}return output.join("")}function toUnicode(input){return mapDomain(input,function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string})}function toASCII(input){return mapDomain(input,function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string})}var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule="object"==typeof module&&module&&!module.nodeType&&module,freeGlobal="object"==typeof global&&global;freeGlobal.global!==freeGlobal&&freeGlobal.window!==freeGlobal&&freeGlobal.self!==freeGlobal||(root=freeGlobal);var punycode,key,maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexPunycode=/^xn--/,regexNonASCII=/[^\x20-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=String.fromCharCode;if(punycode={version:"1.4.1",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode,encode:encode,toASCII:toASCII,toUnicode:toUnicode},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return punycode});else if(freeExports&&freeModule)if(module.exports==freeExports)freeModule.exports=punycode;else for(key in punycode)punycode.hasOwnProperty(key)&&(freeExports[key]=punycode[key]);else root.punycode=punycode}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],28:[function(require,module,exports){"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||"&",eq=eq||"=";var obj={};if("string"!=typeof qs||0===qs.length)return obj;var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;options&&"number"==typeof options.maxKeys&&(maxKeys=options.maxKeys);var len=qs.length;maxKeys>0&&len>maxKeys&&(len=maxKeys);for(var i=0;i<len;++i){var kstr,vstr,k,v,x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq);idx>=0?(kstr=x.substr(0,idx),vstr=x.substr(idx+1)):(kstr=x,vstr=""),k=decodeURIComponent(kstr),v=decodeURIComponent(vstr),hasOwnProperty(obj,k)?isArray(obj[k])?obj[k].push(v):obj[k]=[obj[k],v]:obj[k]=v}return obj};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)}},{}],29:[function(require,module,exports){"use strict";function map(xs,f){if(xs.map)return xs.map(f);for(var res=[],i=0;i<xs.length;i++)res.push(f(xs[i],i));return res}var stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){return sep=sep||"&",eq=eq||"=",null===obj&&(obj=void 0),"object"==typeof obj?map(objectKeys(obj),function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;return isArray(obj[k])?map(obj[k],function(v){return ks+encodeURIComponent(stringifyPrimitive(v))}).join(sep):ks+encodeURIComponent(stringifyPrimitive(obj[k]))}).join(sep):name?encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj)):""};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)},objectKeys=Object.keys||function(obj){var res=[];for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&res.push(key);return res}},{}],30:[function(require,module,exports){"use strict";exports.decode=exports.parse=require("./decode"),exports.encode=exports.stringify=require("./encode")},{"./decode":28,"./encode":29}],31:[function(require,module,exports){(function(global){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_react="undefined"!=typeof window?window.React:"undefined"!=typeof global?global.React:null,_react2=_interopRequireDefault(_react),_reactDom="undefined"!=typeof window?window.ReactDOM:"undefined"!=typeof global?global.ReactDOM:null,_reactDom2=_interopRequireDefault(_reactDom),_NoClosureCreativeReact=require("./components/NoClosureCreativeReact"),_NoClosureCreativeReact2=_interopRequireDefault(_NoClosureCreativeReact);_reactDom2.default.render(_react2.default.createElement(_NoClosureCreativeReact2.default,_extends({},window.props,{win:window})),document.getElementById("root"))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./components/NoClosureCreativeReact":32}],32:[function(require,module,exports){(function(global){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function NoClosureCreativeReact(props){var childProps=props.redirectParameters?(0,_objectAssign2.default)({},props,{decorateLink:(0,_redirectWriter2.default)(props.redirectParameters)}):(0,_objectAssign2.default)({},props,{linkProps:{onClick:function(event){window.trackClick(event.currentTarget.href)},onContextMenu:function(event){window.trackClick(event.currentTarget.href)}}});return _react2.default.createElement(_creativeReact.CreativeReact,childProps)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=NoClosureCreativeReact;var _react="undefined"!=typeof window?window.React:"undefined"!=typeof global?global.React:null,_react2=_interopRequireDefault(_react),_creativeReact=require("creative-react"),_objectAssign=require("object-assign"),_objectAssign2=_interopRequireDefault(_objectAssign),_redirectWriter=require("../libs/redirect-writer"),_redirectWriter2=_interopRequireDefault(_redirectWriter);NoClosureCreativeReact.propTypes=(0,_objectAssign2.default)({},_creativeReact.CreativeReact.propTypes,{redirectParameters:_react2.default.PropTypes.object})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../libs/redirect-writer":33,"creative-react":15,"object-assign":25}],33:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function toPublicUrl(url){return url.indexOf(".staging.")!==-1?url.replace("http:","https:").replace(".staging.dev.","-staging.").replace(".internal",".com").replace(/:[^\/]+/,""):url.indexOf(".prod.")!==-1?url.replace("http:","https:").replace(".prod.",".").replace(".internal",".com").replace(/:[^\/]+/,""):url}function addTrackingParams(link,event){var creativeId=event&&event.payload&&event.payload.creativePersonalization&&event.payload.creativePersonalization.creativeId;if(!creativeId)return link;var isFallback=event&&event.payload&&event.payload.creativePersonalization&&event.payload.creativePersonalization.fallback,params={lkhd_id:creativeId,lkhd_type:isFallback?"fallback":"dynamic"},queryString=Object.keys(params).map(function(k){return k+"="+params[k]}).join("&");return link.indexOf("?")!==-1?link+"&"+queryString:link+"?"+queryString}function redirectWriter(_ref){var baseUrl=_ref.baseUrl,linkParam=_ref.linkParam,eventParam=_ref.eventParam,rawEvent=_ref.rawEvent,event=_ref.event;return"string"==typeof baseUrl&&(baseUrl=_url2.default.parse(baseUrl)),delete baseUrl.search,baseUrl.host=toPublicUrl(baseUrl.host),baseUrl.host=baseUrl.host.replace("render.","published."),baseUrl.query?("string"==typeof baseUrl.query&&(baseUrl.query=_querystring2.default.parse(baseUrl.query)),function(link){var redirected=Object.assign({},baseUrl);return redirected.query=Object.assign({},redirected.query,_defineProperty({},linkParam,addTrackingParams(link,rawEvent)),event&&_defineProperty({},eventParam,event)),_url2.default.format(redirected)}):function(link){return _url2.default.format(Object.assign({},baseUrl,{query:Object.assign(_defineProperty({},linkParam,addTrackingParams(link,rawEvent)),event&&_defineProperty({},eventParam,event))}))}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.toPublicUrl=toPublicUrl,exports.addTrackingParams=addTrackingParams,exports.default=redirectWriter;var _querystring=require("querystring"),_querystring2=_interopRequireDefault(_querystring),_url=require("url"),_url2=_interopRequireDefault(_url)},{querystring:30,url:23}]},{},[31]);
