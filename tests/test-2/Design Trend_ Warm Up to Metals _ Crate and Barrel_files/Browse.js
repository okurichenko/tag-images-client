function FormatPrice(n){return Crate.Utilities.Format.toDollars(n/100)}function GetCurrentPrice(n){if(n>0)return Crate.Utilities.Format.toDollars(n/100)}function ShowSale(n){if(n>0)return!0}function DoRender(n){return n>2?Crate.ProductCompare.config.DoRender=!0:Crate.ProductCompare.config.DoRender}function Remove(n){$(".prodComparePanel[data-sku="+n+"]").addClass("empty");$(".prodComparePanel[data-sku="+n+"] .darea").html("");$(".prodComparePanel[data-sku="+n+"] .prodCompareHelpMsg").show();$(".prodCarouselLI[data-sku="+n+"]").replaceWith("");Crate.ProductCompare.RemoveProduct(n);HideCarousel();AutoHeight()}function AutoHeight(n){$(".prodComparePanel").each(function(){$(this).css("height","")});$(".prodComparePanel .prodCompareDimensions").each(function(){$(this).css("height","")});$(".prodComparePanel .prodCompareDetails").each(function(){$(this).css("height","")});$(".prodComparePanel .prodCompareNamePriceWrap").each(function(){$(this).css("height","")});maxHeight=-1;$(".prodComparePanel .prodCompareDimensions").each(function(){maxHeight=maxHeight>$(this).height()?maxHeight:$(this).height()});$(".prodComparePanel .prodCompareDimensions").each(function(){$(this).height(maxHeight)});maxHeight=-1;$(".prodComparePanel .prodCompareNamePriceWrap").each(function(){maxHeight=maxHeight>$(this).height()?maxHeight:$(this).height()});$(".prodComparePanel .prodCompareNamePriceWrap").each(function(){$(this).height(maxHeight)});maxHeight=-1;$(".prodComparePanel .prodCompareDetails").each(function(){maxHeight=maxHeight>$(this).height()?maxHeight:$(this).height()});$(".prodComparePanel .prodCompareDetails").each(function(){$(this).height(maxHeight)});maxHeight=-1;n||($(".darea").each(function(){$(this).parent().hasClass("empty")||(maxHeight=maxHeight>$(this).height()?maxHeight:$(this).height())}),$(".prodComparePanel").each(function(){$(".empty").size()==3?$(this).height(315):$(this).height(maxHeight)}))}function International(){return Crate.Utilities.Cookies.getCookie("Internationalization")!=null&&Crate.Utilities.Cookies.getCookie("Internationalization")!="US|USD"}function HideCarousel(){var t=[],n;$(".prodComparePanel").find(".prodCarouselLI").each(function(){t.push($(this).data("sku"))});t.length>0&&($.browser.msie&&parseInt($.browser.version,10)===7||(localStorage[Crate.ProductCompare.config.SessionVariableNameLastViewed]=t));n=0;$("#bank .prodCarouselLI").each(function(){$(this).hasClass("ui-draggable-dragging")||(n=n+1)});Crate.ProductCompare.config.CarouselSize=n;n==0&&($("#bank").addClass("hidden"),$(".prodCompareHelpMsgCarousel").addClass("hidden"),$(".prodCompareHelpMsg").addClass("hidden"));n==8?($(".prodCompareCarouselWrap .jcarousel-next").html('<span class="outer"><\/span><span class="inner"><\/span>'),$(".prodCompareCarouselWrap .jcarousel-prev").html('<span class="outer"><\/span><span class="inner"><\/span>')):n-1<=7?($(".jcarousel-next").html(""),$(".jcarousel-prev").html("")):($(".prodCompareCarouselWrap .jcarousel-next").html('<span class="outer"><\/span><span class="inner"><\/span>'),$(".prodCompareCarouselWrap .jcarousel-prev").html('<span class="outer"><\/span><span class="inner"><\/span>'))}function ResetPrevious(){var i,r,n,t;if((!$.browser.msie||parseInt($.browser.version,10)!==7)&&Crate.Utilities.SessionStorage.isAvailable()&&window.localStorage.compareListLastViewed){for(i=window.localStorage.compareListLastViewed.split(","),r=[],n=0;n<Crate.ProductCompare.ItemList.length;n++)for(t=0;t<i.length;t++)if(Crate.ProductCompare.ItemList[n]&&Crate.ProductCompare.ItemList[n].Sku==i[t]){r.push(Crate.ProductCompare.ItemList[n]);Crate.ProductCompare.ItemList.splice(n,1);break}Crate.ProductCompare.ItemList=$.merge(r,Crate.ProductCompare.ItemList)}}function IE7IndexOfCampatability(){Array.prototype.indexOf||(Array.prototype.indexOf=function(n){var i=this.length>>>0,t=Number(arguments[1])||0;for(t=t<0?Math.ceil(t):Math.floor(t),t<0&&(t+=i);t<i;t++)if(t in this&&this[t]===n)return t;return-1})}var Crate=Crate||{};Crate.BoardConfirmation={Config:{PopupUrl:"/favorites/ConfirmationPopup/",DeleteListUrl:"/favorites/RemoveFavoriteBoard/",CopyBoardUrl:"/favorites/CopyBoard/",DesignBoardUrl:"/Favorites/"},Init:function(){Crate.BoardConfirmation.BindEvents()},BindEvents:function(){$("*.js-confirmation").on("click",function(){$("#jsUI").empty();var n=$(this).data("action"),t=$(this).data("recap-id"),i=$(this).closest(".favorites-board-item");Crate.BoardConfirmation.PopupBindEvent(t,i,n)});$(".js-create-list").on("click",function(){$("#js-list-name").removeClass("error");Crate.BoardConfirmation.GetCreateListPopup()});$("*#js-copy-board").one("click",function(){var n=$(this).data("recap-id");Crate.BoardConfirmation.Copy(n)});$("#js-make-copy").one("click",function(){var n=$(this).data("recap-id");Crate.BoardConfirmation.Copy(n)})},GetPopup:function(n){$.ajax({type:"GET",url:Crate.BoardConfirmation.Config.PopupUrl,context:this,success:function(t){n(t)}})},GetCreateListPopup:function(){$.get("/favorites/CreateListPopup",function(n){$("#jsUI").html(n);$(".js-overlay").toggleClass("hidden");$(".popup-content").click(function(n){n.stopPropagation()});$("#js-create-new-list").on("mousedown",function(n){n.stopPropagation();var t=$("#js-list-name").val();Crate.BoardConfirmation.CreateBoardList(t)});$("#js-list-name").focus("click",function(){$("#js-create-new-list").css("display","block")});$("#js-list-name").focusout("click",function(){$("#js-create-new-list").css("display","none")});$(".design-board-new-name").keypress(function(n){if(n.keyCode==13){var t=$("#js-list-name").val();Crate.BoardConfirmation.CreateBoardList(t)}});Crate.BoardConfirmation.PopupClose()})},CreateBoardList:function(n){var i=Crate.DesignBoard.VerifyBoardName(n),t;i&&(t={boardName:n},Crate.DataHelper.Cmd("/favorites/CreateFavoriteBoard",Crate.DataHelper.CallTypes.Post,JSON.stringify(t),function(n){if(n.recapId>0){var t=n.recapId;_satellite.track("Create New Favorites List");location.reload()}else console.log("error creating a new board.")}))},PopupBindEvent:function(n,t,i){Crate.BoardConfirmation.GetPopup(function(r){$("#jsUI").html(r);$(".js-overlay").toggleClass("hidden");i==="delete"&&($("#js-delete-copy").text("Delete List"),Crate.BoardConfirmation.Delete(n,t));Crate.BoardConfirmation.PopupClose();Crate.BoardConfirmation.Cancel();$(".popup-content").click(function(n){n.stopPropagation()})})},Cancel:function(){$(".js-popup-cancel").on("click",function(){Crate.BoardConfirmation.HiddenPopup()})},RemoveList:function(n,t){$.ajax({type:"POST",url:Crate.BoardConfirmation.Config.DeleteListUrl,data:{recapId:n},context:this,success:function(n){t(n)},error:function(n){console.log("Error delete list"+JSON.stringify(n))}})},Delete:function(n,t){$("#js-delete-copy").on("click",function(){Crate.BoardConfirmation.RemoveList(n,function(n){n.Successful?(Crate.BoardConfirmation.HiddenPopup(),t.animate({width:"0",opacity:0},1e3,function(){t.css("margin","0");t.remove();$(".favorites-board-item").length<3&&window.location.reload()})):console.log(n.ErrorMessage)});Crate.Header.LoadBoardFavorites()})},Copy:function(n){var t=JSON.stringify({recapId:n});Crate.DataHelper.Cmd(Crate.BoardConfirmation.Config.CopyBoardUrl,Crate.DataHelper.CallTypes.Post,t,function(n){n.recapId>0&&(console.log("copy board was successfully. "+n.recapId),$(location).attr("href",Crate.BoardConfirmation.Config.DesignBoardUrl+"/fav"+n.recapId))})},PopupClose:function(){$(".js-popup-close, .popup-overlay").click(function(){Crate.BoardConfirmation.HiddenPopup()})},HiddenPopup:function(){$(".js-overlay").toggleClass("hidden")}};$(document).ready(function(){Crate.BoardConfirmation.Init()}),function(n){(function(n){var t=function(n){$(".js-catalog-preference-option",$(n)).click(function(){$(this).val()==0?$(".js-catalog-preference-subscribe-sales-notice").attr("disabled",!0).removeAttr("checked","").prop("checked",!1):$(".js-catalog-preference-subscribe-sales-notice").removeAttr("disabled")})};n.init=t})(n.CatalogPreference||(n.CatalogPreference={}))}(Crate||{});Crate.CompareMetrics={page:{categoryID:null,pageType:null,productID:null},configureWithApiReference:function(n,t){try{n.IsActive&&n.Value!=""&&($.getScript(n.Value),Crate.CompareMetrics.configure(t))}catch(i){console.log(i.message)}},configure:function(n){if(n!=null){if(n.categoryID==null||n.categoryID=="null"||n.pageType==null||n.pageType=="null")return;n.pageType=="category"?$CMPR.configure({categoryID:n.categoryID,pageType:n.pageType}):n.pageType=="product"&&$CMPR.configure({categoryID:n.categoryID,productID:n.productID,pageType:n.pageType})}},isCompareMetricsCategory:function(n,t){if(t.toLowerCase()=="crate")switch(n){case"1267":case"1277":case"1070":case"980":case"14323":case"150":case"940":case"900":case"210":case"1220":case"1230":case"930":case"1010":case"14610":case"14174":case"245":case"14430":case"14870":case"480":case"130":case"14861":case"1288":return!0;default:return!1}return!0},replaceNav:function(n,t,i){i?($("#"+n).addClass("hidden"),$("#"+t).removeClass("hidden")):($("#"+n).removeClass("hidden"),$("#"+t).addClass("hidden"))},reportTransaction:function(){Crate.SPC.Data.Basket!=null&&Crate.SPC.Data.BasketItems!=null&&($CMPR.configure({pageType:"transaction"}),$CMPR.transaction.addTransaction(Crate.SPC.Data.Basket.BasketID+"","Crate & Barrel",Crate.SPC.Data.Basket.GrandTotal+"",Crate.SPC.Data.Basket.TaxTotal+"",Crate.SPC.Data.Basket.ShippingGrandTotal+"","","",""),$(Crate.SPC.Data.BasketItems).each(function(){var n=this.CurrentPrice+"";n=n.substr(0,n.length-2)+"."+n.substr(n.length-2);$CMPR.transaction.addItem(this.BasketID+"",this.Sku+"",this.Title,this.CategoryID+"",parseFloat(n),parseInt(this.Quantity))}),$CMPR.transaction.trackTransaction())}};Crate=Crate||{};Crate.DataHelper={Init:function(){Crate.DataHelper.DataCalls=[]},DataCalls:{},CallTypes:{Post:"POST",Get:"GET",Put:"Put"},Cmd:function(n,t,i,r){try{$.ajax({type:t,url:n,data:i,dataType:"json",contentType:"application/json; charset=UTF-8",error:function(n,t,i){console.log(t+" -|- "+i+" -|- "+n.responseText)},success:function(n){r(n)}})}catch(u){console.log(u)}},getCookie:function(n){for(var r=n+"=",u=document.cookie.split(";"),t,i=0;i<u.length;i++){for(t=u[i];t.charAt(0)==" ";)t=t.substring(1);if(t.indexOf(r)==0)return t.substring(r.length,t.length)}return null},getUrlParameter:function(n){n=n.toLowerCase();for(var u=decodeURIComponent(window.location.search.substring(1).toLowerCase()),r=u.split("&"),t,i=0;i<r.length;i++)if(t=r[i].split("="),t[0]===n)return t[1]===undefined?!0:t[1]}};Crate.DataHelper.Init();Number.prototype.formatMoney=function(n,t,i){var u=this,n=isNaN(n=Math.abs(n))?2:n,t=t==undefined?".":t,i=i==undefined?",":i,e=u<0?"-":"",f=parseInt(u=Math.abs(+u||0).toFixed(n))+"",r=(r=f.length)>3?r%3:0;return e+(r?f.substr(0,r)+i:"")+f.substr(r).replace(/(\d{3})(?=\d)/g,"$1"+i)+(n?t+Math.abs(u-f).toFixed(n).slice(2):"")};Array.prototype.chunk=function(n){return this.length?[this.slice(0,n)].concat(this.slice(n).chunk(n)):[]};var getUrlParameter=function(n){n=n.toLowerCase();for(var u=decodeURIComponent(window.location.search.substring(1).toLowerCase()),r=u.split("&"),t,i=0;i<r.length;i++)if(t=r[i].split("="),t[0]===n)return t[1]===undefined?!0:t[1]},BlobItem=function(n){this.ImageID=n.ImageID||n.Id;this.Sku=n.Sku;this.SwatchId=n.SwatchId||0;this.X=n.X||0;this.Y=n.Y||0;this.Height=n.Height;this.Width=n.Width;this.Rotation=n.Rotation||0;this.zIndex=n.zIndex||0},DesignBoardServiceAgent=function(){var n={saveBlobUrl:"/favorites/SaveFavoriteBoardBlob",getBlobUrl:"/favorites/GetDesignBoardData/",removeItemUrl:"/favorites/RemoveItemFromFavorites/",parameterName:"recapId"},t;this.init=function(t){$.extend(n,t)};this.removeItemCanvas=function(t,i,r){$.ajax({type:"POST",url:n.removeItemUrl,data:{recapId:i,itemId:t},success:function(n){r(n)}})};this.SaveBlobs=function(t,i){$.ajax({url:n.saveBlobUrl,type:"POST",data:{json:JSON.stringify(t),recapId:i},complete:function(){console.log("blob was saved.")}})};t=function(n,t){return{x:t/n.length/t*100,y:0,cols:n.length}};this.GetBlobs=function(t,i){var r=getUrlParameter("givenEmail"),u="";r!==undefined&&(u="&givenEmail="+r);$.ajax({url:n.getBlobUrl+"?"+n.parameterName+"="+t+u,type:"GET",dataType:"json",contentType:"application/json; charset=UTF-8",complete:function(n){var t=[],f=[],r,u;n.responseJSON!==undefined&&n.responseJSON.length&&n.responseJSON.forEach(function(n){t.push(new BlobItem(n));f.push(n.Sku+String(n.SwatchId))});r=0;u=Crate.Model.BoardProducts;Crate!=undefined&&u!=undefined&&u.forEach(function(n){f.indexOf(n.Sku+String(n.SwatchId))==-1&&t.push(new BlobItem(n));r+=n.QuantityWants});Crate.MoodBoard.BeginItemCount=r;i(t)}})}},currentZindex,DesignBoardItem=function(n,t){var f,r=n.canvas,b=n.imgSize,k=n.maxResizeWid,d=n.minResizeWid,u=r.width(),s=r.height(),i={},e=function(n){var f=String(t.Sku),r;if(t.SwatchId!=null&&t.SwatchId!=0&&(f+=String(t.SwatchId)),r=$("#designboard-canvas").height(),n==null&&i.image.height()>r)while(i.image.height()>r)t.Width=t.Width*.9,TweenLite.set(i.drag,{width:t.Width*100+"%"});else n=n/u,t.Width=n||t.Width,(t.Width==1||t.Width==100)&&(t.Width=.3),TweenLite.set(i.drag,{width:t.Width*100+"%"})},a=function(){TweenLite.set(i.drag,{x:t.X*u/100,y:t.Y*s/100})},h=function(){i.drag.css("z-index",t.zIndex)},o=function(){currentZindex=board.getMaxZindex();t.zIndex=(currentZindex||t.zIndex)+1;currentZindex=t.zIndex;h()},c=function(){TweenLite.set(i.spin,{rotation:t.Rotation})},l=function(){$(".draggable").removeClass("selected");i.drag.addClass("selected");o()},g=function(){function f(n){n.scale<2&&n.scale>.5&&(t.Scale=n.scale,e());n.rotation<120&&n.rotation>-120&&(t.Rotation=n.rotation,c())}var n=new Hammer.Manager(i.spin),r=new Hammer.Pinch,u=new Hammer.Rotate;r.recognizeWith(u);n.add([r,u]);n.on("pinch rotate",f)},nt=function(n){$.extend(t,n);blobUpdate(t)},v=function(){var n=Draggable.create(i.drag,{zIndexBoost:!1,bounds:r,throwProps:!0,onRelease:function(){t.X=n[0].x/u*100;t.Y=n[0].y/s*100},onPress:l})},y=function(){var n=Draggable.create(i.spin,{bounds:r,trigger:i.rotateHandle,dragResistance:.4,type:"rotation",throwProps:!0,onPress:function(n){n.stopPropagation()},onRelease:function(){t.Rotation=n[0].rotation}})},p=function(){var s=t.Width*u,f=n.maxResizeWid*u,o=n.minResizeWid*u,h=Draggable.create(i.resizeHandle,{type:"bottom, right",bounds:r,onPress:function(n){n.stopPropagation()},onDrag:function(){if(this.y<this.maxY&&this.x<this.maxX){var n=this.x>f?f:this.x<o?o:this.x;e(n)}}})},w=function(){var f=!1,u;$("#ReadOnlyCheck").length&&(f=!0);u=t.SwatchId=="0"?"":t.SwatchId.toString();i.drag=$("<div class='draggable' id='"+t.Sku.toString()+u.toString()+"'><\/div>").appendTo(r);i.spin=$("<div class='spin'><\/div>").appendTo(i.drag);$("<div class='circle handle'><\/div><div class='circle handle'><\/div><div class='circle handle'><\/div><div class='circle handle'><\/div>").appendTo(i.spin);i.image=u!=""?$('<img src="//images.crateandbarrel.com/is/image/Crate/'+t.Sku+"_"+u+'_mod?fmt=png-alpha" max-height="'+n.canvas.height()+'" max-width="'+n.canvas.width()+'" />').appendTo(i.spin):$('<img src="//images.crateandbarrel.com/is/image/Crate/'+t.Sku+'_mod?fmt=png-alpha"  max-height="'+n.canvas.height()+'" max-width="'+n.canvas.width()+'"/>').appendTo(i.spin);i.image.load(function(){e()});i.option=$("<div class='option'><\/div>").appendTo(i.drag);f||(i.remove=$("<i class='handle remove' ><\/i>").appendTo(i.spin),i.resizeHandle=$("<div class='handle resize'><div class='resize-handle'><\/div><i class='icon-ico_arrowsize_md'><\/i><\/div>").appendTo(i.spin),i.rotateHandle=$("<div class='handle rotate'><div class='rotate-handle'><\/div><i class='icon-ico_arrowrotate_md'><\/i><\/div>").appendTo(i.spin))};return f={updateImagePosition:a,updateImageSize:e,updateZindex:h,bringToFront:o,updateRotation:c,selectImage:l,makeResizeable:p,makeDraggable:v,makeSpinnable:y},f.bringToFront=o,f.render=w,f.item=i,f},DesignBoard=function(){var n={recapId:$("#_recapId").val(),imgSize:.4,maxResizeWid:.8,minResizeWid:.1,canvas:$("#designboard-canvas"),aspectRatio:1.33},r=new DesignBoardServiceAgent,t=[],f=function(t){$.extend(n,t);recapId=n.recapId;r.GetBlobs(recapId,function(n){h(n)});e()},e=function(){n.canvas.click(function(n){$(n.target).closest(".draggable").hasClass("selected")||$(".draggable").removeClass("selected");$(n.target).closest("img").length&&(n.target.tabIndex=-1,n.target.focus())})},o=function(n,t){return{x:t/n.length/t*100,y:0,cols:n.length}},s=function(n){var r=[],f=$("#designboard-canvas").width(),e=$("#designboard-canvas").height(),t=o(n,f,e),s=n.length,h=n.chunk(s),i=0,u=0;return h.forEach(function(n){i=0;n.forEach(function(n){n.X!=0||n.Y!=0||(n.X=i,n.Y=u,n.Width=t.x/100,n.Height=t.y/100);i+=t.x;r.push(n)});u+=t.y}),r},h=function(n){return s(n).forEach(i)},c=function(){return t},l=function(){var n=t.reduce(function(n,t){return Number(t.zIndex)>Number(n.zIndex)?t:n});return n.zIndex},u=function(n,t,i,r){Crate.MoodBoard.RemoveLineItem(i,r)},a=function(){r.SaveBlobs(t,recapId)},v=n.canvas.width(),i;return n.canvas.height(v/n.aspectRatio),i=function(i,r){var f,e;if(t.push(i),f=DesignBoardItem(n,i),f.render(),e=!1,$("#ReadOnlyCheck").length&&(e=!0),e||(f.makeDraggable(),f.makeSpinnable(),f.makeResizeable()),f.updateImagePosition(),f.updateZindex(),f.updateRotation(),!e){f.item.remove.on("click touchstart",function(){return u(f,r,i.Sku,i.SwatchId)});f.item.image.on("keydown",function(n){if(n.keyCode==46)return u(f,r,i.Sku,i.SwatchId)})}},{add:i,init:f,save:a,getCanvas:c,getMaxZindex:l}};board={};$(document).ready(function(){if($("#designboard-canvas").length){var n=$("#_recapId").val();board=DesignBoard();board.init({recapId:n})}else Crate.MoodBoard.SetItemCount()});Crate=Crate||{};Crate.MoodBoard={Init:function(){Crate.MoodBoard.BindEvent();Crate.MoodBoard.UpdateTotalPrice()},BeginItemCount:0,CurrentItemCount:0,Selectors:{AddItemUrl:"/favorites/AddItemToCanvas/",UpdateQtyWantsUrl:"/favorites/UpdateItemFavoriteQtyWants/",SaveBoardName:"/favorites/UpdateFavoriteBoardName",CopyBoardUrl:"/favorites/CopyBoard/",RecapId:"#_recapId"},BindEvent:function(){$(".js-add-to-board").on("click",function(){var n=$(this).data("sku"),t=$(this).data("swatch-id");Crate.MoodBoard.AddItemToCanvas(n,t)});$(".js-save-blob").on("click",function(){$(".js-save-blob").prop("disabled",!0);$(".js-save-blob").text("Saving...");$.when(board.save()).done(function(){$(".js-save-blob").prop("disabled",!1);$(".js-save-blob").addClass("tom").html('<i title="board-saved" class="board-saved" id="board-saved"><\/i>Saved').delay(2e3).queue(function(){$(this).removeClass("tom").dequeue();$(".js-save-blob").text("Save Layout")})})});$(".js-delete-item").on("click",function(){var n=$(this).data("sku"),t=$(this).data("swatch-id");Crate.MoodBoard.RemoveLineItem(n,t)});$(".js-qty-wants").on("blur",function(){var t=$(this).data("item-id"),i=$(this).data("swatch-id"),r=$(this).data("cb-model").replace("Qty",""),n;$(this).val()==0&&$(this).val(1);n=$(this).val();Crate.MoodBoard.AddQtyWants(t,n,r,i)});$(".js-edit-name").on("keypress paste",function(n){if($(this).val().length>$(this).attr("max"))return n.preventDefault(),!1});$(".js-edit-name").on("focus",function(){$(".js-edit-button").fadeOut()});$(".js-edit-name").on("blur",function(){var n=$(this).val(),t=$("#_recapId").val();if(n==""||n.toLowerCase()=="my favorites"){$(".js-edit-name").addClass("error");return}$(".js-edit-name").removeClass("error");Crate.MoodBoard.SaveBoardName(t,n)});$(".js-edit-name").keypress("blur",function(n){if(n.keyCode==13){var t=$(this).val(),i=$("#_recapId").val();if(t==""||t.toLowerCase()=="my favorites"){$(".js-edit-name").addClass("error");$(".js-edit-name").focusout();return}$(".js-edit-name").removeClass("error");Crate.MoodBoard.SaveBoardName(i,t)}});$(".js-edit-button").on("click",function(){var n=$(this).closest("div").children(".js-edit-name");n.focus();n[0].setSelectionRange(0,0)});$(".js-copy-list").on("click",function(){var n=$(Crate.MoodBoard.Selectors.RecapId).val();$.ajax({type:"POST",url:Crate.MoodBoard.Selectors.CopyBoardUrl,data:{recapId:n},context:this,success:function(n){console.log("copy board was successfully. "+n.recapId)},error:function(n){console.log("error on copying board "+JSON.stringify(n))}})})},SaveBoardName:function(n,t){var i={recapId:n,name:t};Crate.DataHelper.Cmd(Crate.MoodBoard.Selectors.SaveBoardName,Crate.DataHelper.CallTypes.Post,JSON.stringify(i),function(n){n.Successful?$("#save-msg").fadeIn(600).delay(2e3).queue(function(){$(this).fadeOut(600).dequeue();$(".js-edit-button").delay(500).fadeIn()}):console.log(n.ErrorMessage)});Crate.Header.LoadBoardFavorites()},RemoveLineItem:function(n,t){if(!$("#ReadOnlyCheck").length){var i=$("[data-sku="+n+"][data-swatch-id="+t+"]"),r=i.data("item-id"),u=new DesignBoardServiceAgent;u.removeItemCanvas(r,$(Crate.MoodBoard.Selectors.RecapId).val(),function(r){var u,f,e;if(r.Successful){if(u=i.closest(".favorite-line-item"),u.animate({height:"0",opacity:0},1e3,function(){u.css("margin","0");u.remove()}),!$.isEmptyObject(board)){var o=t!=0?t:"",s=n.toString()+o.toString(),h=$("div.draggable").filter(function(){return this.id==s});h.remove();f=board.getCanvas();$.each(f,function(i){this.Sku==n&&this.SwatchId==t&&f.splice(i,1)});$.each(Crate.Model.BoardProducts,function(i){this.Sku==n&&this.SwatchId==t&&Crate.Model.BoardProducts.splice(i,1)});e=new DesignBoardServiceAgent;e.SaveBlobs(f,$(Crate.MoodBoard.Selectors.RecapId).val());Crate.MoodBoard.UpdateTotalPrice()}Crate.Header.LoadBoardFavorites();Crate.MoodBoard.CurrentItemCount==0&&(Crate.MoodBoard.CurrentItemCount=Crate.MoodBoard.BeginItemCount);Crate.MoodBoard.CurrentItemCount-=1;Crate.MoodBoard.BeginItemCount>20&&Crate.MoodBoard.CurrentItemCount==20&&window.location.reload()}else console.log(r.ErrorMessage)})}},SetItemCount:function(){var n=0;Crate.Model!=undefined&&Crate.Model.BoardProducts!=undefined&&Crate.Model.BoardProducts.forEach(function(t){n+=t.QuantityWants});Crate.MoodBoard.BeginItemCount=n},FindIndexBlob:function(n,t,i){for(var r=0;r<n.length;r++)if(n[r][t]==i)return r;return null},AddQtyWants:function(n,t,i,r){if(!$("#ReadOnlyCheck").length){var u={recapId:$("#_recapId").val(),favoriteItemId:n,quantityWants:t};Crate.DataHelper.Cmd(Crate.MoodBoard.Selectors.UpdateQtyWantsUrl,Crate.DataHelper.CallTypes.Post,JSON.stringify(u),function(u){u.Successful?(console.log("Update qty item "+n+" success."),$.each(Crate.Model.BoardProducts,function(n){this.Sku==i&&this.SwatchId==r&&(Crate.Model.BoardProducts[n].QuantityWants=t)}),Crate.Header.LoadBoardFavorites(),Crate.MoodBoard.UpdateTotalPrice()):console.log("error when updating item quantity.")})}},UpdateTotalPrice:function(){if($(".jsMoodTotalPrice").length){var n=0;Crate.Model.BoardProducts.forEach(function(t){var i=0;t.SwatchId!=""&&(i=t.SwatchId);$('.js-delete-item[data-sku="'+t.Sku+'"][data-swatch-id="'+i+'"]').length&&(n+=t.Price*t.QuantityWants)});$(".jsMoodTotalPrice").html("$"+n.formatMoney(2,".",","))}},AddItemToCanvas:function(n,t){$.ajax({type:"POST",url:Crate.MoodBoard.Selectors.AddItemUrl,data:{recapId:$(Crate.MoodBoard.Selectors.RecapId).val(),sku:n,swatchid:t},success:function(n){console.log("we get the image");var i=$.parseHTML(n),t=$(i).closest("div.draggable");$("#canvas.mb").append(t);console.log("we added to the canvas");Crate.MoodBoard.MakeDraggableElement(t);board.save()}})}};Crate.DesignBoard={Item:{},SelectList:function(n){var t=jQuery(n.currentTarget).data("recapid"),r=jQuery(n.currentTarget).data("boardname"),u=$(".jsSpecialOrderDesktopPage").val(),i;u&&(i=$(".jsSoSku").val(),Crate.DesignBoard.item.Sku=i);isFinite(Crate.DesignBoard.item.Quantity)&&Crate.DesignBoard.item.Quantity!==null||(Crate.DesignBoard.item.Quantity=1);$.get("/favorites/AddItemToFavorites?sku="+Crate.DesignBoard.item.Sku+"&swatchId="+Crate.DesignBoard.item.SwatchID+"&quantity="+Crate.DesignBoard.item.Quantity+"&recapId="+t,function(){$(".popup-overlay").addClass("hidden");$(".js-overlayCheck").removeClass("hidden");$(".jsConfirmView").attr("href","/Favorites/fav"+t);$("#jsConfirmBoard").text("Added to "+r);$(".js-overlayCheck").delay(3e3).fadeOut();typeof Crate.HeaderNav=="undefined"?Crate.Header.LoadBoardFavorites():Crate.HeaderNav.LoadBoardFavorites();Crate.DesignBoard.SetFavoriteHearts(Crate.DesignBoard.item.Sku);_satellite.track("Favorites Popup")})},init:function(){$("body").on("click",".jsDesignBoardFavorites",function(){var t=$(".jsSpecialOrderDesktopPage").val(),n,i,r;$("#QuickLookCheck").length&&t!=="quicklook"&&$(".ui-dialog-titlebar-close").click();n=$(this).closest(".jsItemRow");Crate.DesignBoard.item={};t?(i=$(".jsSoSku").val(),Crate.DesignBoard.item.Sku=i):(Crate.DesignBoard.item.Sku=n.find("input.jsSku").val(),(Crate.DesignBoard.item.Sku==null||Crate.DesignBoard.item.Sku==0)&&(Crate.DesignBoard.item.Sku=n.find(".jsCompareSku").val()),(Crate.DesignBoard.item.Sku==null||Crate.DesignBoard.item.Sku==0)&&(Crate.DesignBoard.item.Sku=$(this).data("sku")),(Crate.DesignBoard.item.Sku==null||Crate.DesignBoard.item.Sku==0)&&(Crate.DesignBoard.item.Sku=$(this).data("family")));Crate.DesignBoard.item.Quantity=n.find("input.jsQty").val();Crate.DesignBoard.item.Quantity&&Crate.DesignBoard.item.Quantity!==""||n.find("input.jsNumeric").val();Crate.DesignBoard.item.SwatchID=parseInt(n.find("input.jsSwatch").val()||0,10);Crate.DesignBoard.item.SwatchID==null&&(Crate.DesignBoard.item.SwatchID=$(this).data("swatch-id"));Crate.DesignBoard.item.SwatchID==null&&(Crate.DesignBoard.item.SwatchID="0");r=this;$(".ui-dialog-titlebar-close").click();$("#jsUI").empty();$.get("/favorites/AddToListPopup?sku="+Crate.DesignBoard.item.Sku+"&swatchId="+Crate.DesignBoard.item.SwatchID,function(n){$("#jsUI").html(n);$(".js-overlay").removeClass("hidden");$(".js-popup-close, .popup-overlay").on("click",function(){$(".js-overlay").addClass("hidden");$(".js-overlayCheck").addClass("hidden");$(".popup-content").click(function(n){n.stopPropagation()})});$(".js-popup-closeCheck, .popup-overlay").on("click",function(){$(".js-overlayCheck").addClass("hidden");$(".popup-content").click(function(n){n.stopPropagation()})});$(".popup-content").click(function(n){n.stopPropagation()});$("#jsSubmitCreateNewDesignBoard").on("mousedown",function(n){n.stopPropagation();$("#jsSubmitCreateNewDesignBoard").css("display","block");var t=$("#jsDesignBoardName").val();Crate.DesignBoard.CreateBoardFavoritedItem(t,Crate.DesignBoard.item.Sku,Crate.DesignBoard.item.SwatchID,Crate.DesignBoard.item.Quantity)});$("#jsDesignBoardName").focus("click",function(){$("#jsSubmitCreateNewDesignBoard").css("display","block")});$("#jsDesignBoardName").focusout("click",function(){$("#jsSubmitCreateNewDesignBoard").css("display","none")});$(".popup-content").keypress(function(n){if(n.keyCode==13){var t=$("#jsDesignBoardName").val();Crate.DesignBoard.CreateBoardFavoritedItem(t,Crate.DesignBoard.item.Sku,Crate.DesignBoard.item.SwatchID,Crate.DesignBoard.item.Quantity)}})});$(document).keyup(function(n){n.keyCode==27&&$(".popup-overlay").addClass("hidden")})})},GetFavoritedItems:function(n){var n,t;n.length==0&&(n=[],$(".jsSpillFavoriteIcon").each(function(t,i){n[t]=$(i).data("sku")}));n.length&&(t=JSON.stringify({skus:n}),Crate.DataHelper.Cmd("/favorites/GetSkuMembership/",Crate.DataHelper.CallTypes.Post,t,function(n){n.length&&n.forEach(function(n){$('.jsSpillFavoriteIcon[data-sku="'+n+'"]').removeClass("empty-icon-favorites");$('.jsSpillFavoriteIcon[data-sku="'+n+'"]').addClass("icon-favorites")})}))},VerifyFavoritesCookies:function(){var n=Crate.DataHelper.getCookie("FavoriteTrackingCookie"),t=Crate.DataHelper.getCookie("Account");(n!=null||t!=null)&&Crate.DesignBoard.GetFavoritedItems([])},VerifyBoardName:function(n){return n==""?($(".new-list-input-wrap").addClass("error"),!1):!0},SetFavoriteHearts:function(n){$('.jsSpillFavoriteIcon[data-sku="'+n+'"]').removeClass("empty-icon-favorites");$('.jsSpillFavoriteIcon[data-sku="'+n+'"]').addClass("icon-favorites")},CreateBoardFavoritedItem:function(n,t,i,r){var f=Crate.DesignBoard.VerifyBoardName(n),u;f&&(u={boardName:n,sku:t,swatchId:i,quantity:r},Crate.DataHelper.Cmd("/favorites/CreateBoard/",Crate.DataHelper.CallTypes.Post,JSON.stringify(u),function(t){t.recapId>0&&($(".popup-overlay").addClass("hidden"),$(".js-overlayCheck").removeClass("hidden"),$(".jsConfirmView").attr("href","/Favorites/fav"+t.recapId),$("#jsConfirmBoard").text("Added to "+n),$(".js-overlayCheck").delay(3e3).fadeOut(),typeof Crate.HeaderNav=="undefined"?Crate.Header.LoadBoardFavorites():Crate.HeaderNav.LoadBoardFavorites(),Crate.DesignBoard.SetFavoriteHearts(Crate.DesignBoard.item.Sku),_satellite.track("Create New Favorites List"),_satellite.track("Favorites Popup"))}))}};$(document).ready(function(){Crate.DesignBoard.init();Crate.MoodBoard.Init();Crate.DesignBoard.VerifyFavoritesCookies()});$(document).ready(function(){$(".js-mood-toggle").click(function(){var n="";n=$(this).hasClass("active")?"/favorites/SetBoardMinimized/":"/favorites/SetBoardUnMinimized/";$.ajax({type:"POST",url:n,data:{recapId:$("#_recapId").val()},context:this,success:function(){}})});$("#jsMakeMoodBoard").click(function(){$.ajax({type:"POST",url:"/favorites/MakeListMoodBoard",data:{recapId:$("#_recapId").val()},context:this,success:function(){location.reload()}})})});$(document).ready(function(){$(".sign-in-alert").delay(2e3).fadeIn(800).delay(3e3).fadeOut(800)}),function(n){(function(t){function i(t,i,r){t.responseJSON.Succeeded===!1?($("*#addValidation").empty(),$("*#addValidation").removeClass("validation-error"),$(".registryMsg"+t.responseJSON.Sku).html(t.responseJSON.ResultMessage),$(".registryMsg"+t.responseJSON.Sku).addClass("validation-error")):(t.responseJSON.AddType==="addToCart"&&(n.AddItem.addToCartOnSuccessDesktop(r,t.responseJSON.Sku,t.responseJSON.Quantity),$(".ui-dialog-titlebar-close").click()),t.responseJSON.AddType==="addToFavorites"&&($("#addToFavoritesButton").addClass("hidden"),$(".addedToFavorites").removeClass("hidden")),t.responseJSON.AddType==="addToRegistry"&&(n.AddItem.addToRegistryOnSuccessDesktop(r,t.responseJSON.Sku,t.responseJSON.Quantity),$(".ui-dialog-titlebar-close").click()))}t.addComplete=i})(n.FavoritesRegistry||(n.FavoritesRegistry={}));var t=n.FavoritesRegistry}(Crate||(Crate={}));Crate=Crate||{};Crate.OrderFreeSwatches={init:function(){Crate.OrderFreeSwatches.setupCheckboxes();Crate.OrderFreeSwatches.setupFields()},setupCheckboxes:function(){var n=$('#order-swatches-form input[type="checkbox"].a11y-checkbox'),t=$("#order-swatches-form input:checkbox:not(:checked).a11y-checkbox");n.change(function(){var i=n.filter(":checked").length;i<5?t.prop("disabled",!1):t.not(":checked").prop("disabled",!0);i===0?$(SwatchSelected).val(""):$(SwatchSelected).val("1")})},setupFields:function(){Crate.OrderFreeSwatches.markRequiredField("FirstName");Crate.OrderFreeSwatches.markRequiredField("LastName");Crate.OrderFreeSwatches.markRequiredField("Address1");Crate.OrderFreeSwatches.markNonRequiredField("Address2");Crate.OrderFreeSwatches.markRequiredField("City");Crate.OrderFreeSwatches.markRequiredField("State");Crate.OrderFreeSwatches.markRequiredField("PostalCode");Crate.OrderFreeSwatches.markRequiredField("DayPhone");Crate.OrderFreeSwatches.markRequiredField("EmailAddress")},markRequiredField:function(n){var i=document.createElement("span"),t;i.innerHTML='<span class="required">Required<\/span>';t=$("label[for='"+n+"']");t.text(t.text()+": ");t.append(i)},markNonRequiredField:function(n){var t=$("label[for='"+n+"']");t.text(t.text()+": ")},submit:function(n){var n=$("#order-swatches-form"),t;n.find(".jsSubmit").addClass("progressWheel");t=n.serializeArray();$.ajax({url:"/browse/specialorder/orderfreeswatchessubmit",data:t,type:"POST",success:function(n){Crate.OrderFreeSwatches.submitComplete(n)},error:function(){Crate.OrderFreeSwatches.handleError()}});n.find(".jsSubmit").removeClass("progressWheel")},submitComplete:function(n){if(n.Succeeded===!0){var t=$("#order-swatches-form");Crate.Val.$.replaceFormContent(t,n.Message)}else Crate.OrderFreeSwatches.handleError()},handleError:function(){var t=$("#order-swatches-validation"),n;t.empty();n=document.createElement("span");n.innerHTML="An error occurred while submitting your order.";t.append(n)},validateAddress:function(){var t=$("#order-swatches-form"),n,r,i;return t.find(".jsSubmit").addClass("progressWheel"),n=new Crate.AJAX.Request("RequestSwatch|Request"),n.FirstName=$("#FirstName").val(),n.Middleinitial=null,n.LastName=$("#LastName").val(),n.Company=null,n.Address1=$("#Address1").val(),n.Address2=$("#Address2").val(),n.City=$("#City").val(),n.State=$("#State").val(),n.ZIP=$("#PostalCode").val(),n.DayPhone=Crate.Val.$.CleanPhone($("#DayPhone").val()),n.NightPhone=null,n.Email=$("#EmailAddress").val(),n.OptIn=!1,n.SwatchIDs=$.map($(".jsSwatchOption:checked"),function(n){return Number($(n).val())}),r=function(){Crate.OrderFreeSwatches.submit(t)},i=new Crate.Val.AddressAVS,i.register({obj:n,messageContainer:"#order-swatches-validation",address1:"#Addres1",address2:"#Address2",city:"#City",state:"#State",ZIP:"#PostalCode",onSuccess:r}),i.validate(t),t.find(".jsSubmit").removeClass("progressWheel"),!1}};$(document).ready(function(){Crate.ProductCompare.InitSpill()});Crate=Crate||{};Crate.ProductCompare={config:{DoRender:!0,SkuArrayVariableName:"compareList",SessionVariableNameLastViewed:"compareListLastViewed",CarouselSize:0},init:function(){var n=/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent);$.views.helpers({FormatPrice:FormatPrice,GetCurrentPrice:GetCurrentPrice,ShowSale:ShowSale,DoRender:DoRender,Remove:Remove,International:International});$(window).scroll(function(){n||($(".prodComparePanelWrap").position().top-$(window).scrollTop()+48<=0?($(".prodCompareImg").addClass("fixit"),$(".prodCompareNamePriceWrap").addClass("wrapFixit")):($(".prodCompareImg").removeClass("fixit"),$(".prodCompareNamePriceWrap").removeClass("wrapFixit")))});ResetPrevious();Crate.ProductCompare.ItemList&&Crate.ProductCompare.ItemList.length>3&&(Crate.ProductCompare.config.DoRender=!1,Crate.ProductCompare.RenderCarousel(),$(".prodCompareCarouselWrap").removeClass("hidden"));Crate.ProductCompare.RenderTemplate();Crate.Carousel.init(7,1,1,"#carousel");AutoHeight(!0);$("input.jsNumeric").numeric();$(".draggable").each(function(n,t){$(t).draggable({stop:function(){$(".droppable").droppable("option","disabled",!1)},helper:"clone",connectToSortable:"#ProductCompareData",cursor:"move",appendTo:"body",start:function(n,t){$(t.helper).addClass("hoverDrag");$(this).addClass("dragPlaceholder")},revert:function(n){return $(this).removeClass("dragPlaceholder"),$(this).data("uiDraggable").originalPosition={top:0,left:0},!n}})});$(".prodCompareCarouselWrap").droppable({tolerance:"touch",drop:function(n,t){var r,i;if(Crate.ProductCompare.config.CarouselSize>0&&n.handleObj.namespace=="sortable"&&$(n.target).hasClass("prodCompareCarouselWrap")){for(r="",Crate.ProductCompare.config.DoRender=!0,i=0;i<Crate.ProductCompare.ItemList.length;i++)if(Crate.ProductCompare.ItemList[i].Sku==$(t.draggable).find(".prodCarouselLI").data("sku")){r=$("#ProductCompareCarouselTemplate").render(Crate.ProductCompare.ItemList[i]);break}$("#carousel").append(r);$(this).find(".draggable").each(function(n,t){$(t).draggable({stop:function(){$(".droppable").droppable("option","disabled",!1)},helper:"clone",connectToSortable:"#ProductCompareData",cursor:"move",appendTo:"body",start:function(n,t){$(t.helper).addClass("hoverDrag");$(this).addClass("dragPlaceholder")},revert:function(n){return $(this).removeClass("dragPlaceholder"),$(this).data("uiDraggable").originalPosition={top:0,left:0},!n}})});$(t.draggable).find(".prodCompareHelpMsg").show();$(t.draggable).addClass("empty");$(t.draggable).children(".darea").html("");$(t.draggable).find(".prodCarouselLI").replaceWith("");Crate.Carousel.init(7,1,1,"#carousel");HideCarousel(!0)}}});$("#ProductCompareData").sortable({sort:function(){},handle:n?".prodComparePanelDragIcon":"",receive:function(n,t){t.item.remove()},update:function(){HideCarousel(!1)}});$(".droppable").droppable({cursor:"move",helper:"clone",scroll:!1,appendTo:"#ProductCompareData",start:function(){},connectWith:"#ProductCompareData",stop:function(){},over:function(n){$(".prodComparePanelWrap div").removeClass("prodCompareBorder");$(this).attr("id")=="jsdropCompareArea"&&$(n.target).addClass("prodCompareBorder")},drop:function(n,t){var r,i;if(Crate.ProductCompare.config.CarouselSize>0&&(r="",n.handleObj.namespace=="draggable"&&$(n.target).attr("id")=="jsdropCompareArea")){for($(this).find(".prodCompareHelpMsg").hide(),$(this).removeClass("empty"),$(this).find(".ui-draggable .jsItemLi").removeClass("hidden"),$("#bank #carousel").append($(".ui-draggable",this)),$(this).append(t.draggable),Crate.ProductCompare.config.DoRender=!1,i=0;i<Crate.ProductCompare.ItemList.length;i++)if(Crate.ProductCompare.ItemList[i].Sku==$(t.draggable).data("sku")){r=$("#ProductCompareTemplate").render(Crate.ProductCompare.ItemList[i]);$(this).attr("data-sku",$(t.draggable).data("sku"));break}$(this).children(".darea").html(r);$(this).find(".ui-draggable .jsItemLi").addClass("hidden");$(".prodComparePanelWrap div").removeClass("prodCompareBorder");AutoHeight();HideCarousel(!0)}}})},RenderTemplate:function(){for(var t="",n=0;n<=2;n++)n<=2&&Crate.ProductCompare.ItemList[n]&&(t+=$("#ProductCompareTemplate").render(Crate.ProductCompare.ItemList[n]).replace("currentItem",Crate.ProductCompare.ItemList.length-n));HideCarousel();$("#ProductCompareData").html(t)},RenderCarousel:function(){var n=$("#ProductCompareCarouselTemplate").render(Crate.ProductCompare.ItemList);$("#carousel").html(n)},GetSkuCompareArray:function(){var n=null;return(n=Crate.Utilities.SessionStorage.getItem(Crate.ProductCompare.config.SkuArrayVariableName),Crate.Utilities.SessionStorage.isAvailable()&&n!=null&&n!="")?n.split(","):(n=Crate.Utilities.Cookies.getCookie(Crate.ProductCompare.config.SkuArrayVariableName),n!=null&&n!="")?n.split(","):null},SetSkuCompareArray:function(n){var t=Crate.Utilities.SessionStorage.getItem(Crate.ProductCompare.config.SkuArrayVariableName);return Crate.Utilities.SessionStorage.isAvailable()?Crate.Utilities.SessionStorage.setItem(Crate.ProductCompare.config.SkuArrayVariableName,n):Crate.Utilities.Cookies.setCookie(Crate.ProductCompare.config.SkuArrayVariableName,n),null},RemoveSkuCompareArray:function(){Crate.Utilities.SessionStorage.removeItem(Crate.ProductCompare.config.SkuArrayVariableName);Crate.Utilities.Cookies.deleteCookie(Crate.ProductCompare.config.SkuArrayVariableName)},InitSpill:function(){var n=Crate.ProductCompare.GetSkuCompareArray();n!=null&&$.each(n,function(n,t){$miniSetWrap=$("#MiniSetWrapper"+t);$miniSetWrap.find(".jsCompareAdd").hide();$miniSetWrap.find(".jsCompareView").show()})},AddProduct:function(n){var r=$(n.target).closest(".jsItemRow").find(".jsCompareSku"),i,t;r.length>0&&(i=r.val(),t=Crate.ProductCompare.GetSkuCompareArray(),t!=null?t.indexOf(i)<0&&t.push(i):t=i,Crate.ProductCompare.SetSkuCompareArray(t),$(n.target).hide(),$(n.target).parent().find(".jsCompareView").show())},AddToCart:function(n,t){$(".prodComparePanel[data-sku="+$(n.target).data("sku")+"]").addClass("jsItemRow");Crate.Shopping.AddItems(n,t,!0);$(".prodComparePanel[data-sku="+$(n.target).data("sku")+"]").removeClass("jsItemRow");AutoHeight()},RemoveProduct:function(n){var t=Crate.ProductCompare.GetSkuCompareArray(),i;if(t!=null&&(($.browser.msie&&parseInt($.browser.version,10)===7||$.browser.msie&&parseInt($.browser.version,10)===8)&&IE7IndexOfCampatability(),i=t.indexOf(n.toString()),i>=0)){if(t.length===1){Crate.ProductCompare.RemoveSkuCompareArray();return}t.splice(i,1);Crate.ProductCompare.SetSkuCompareArray(t)}},ViewComparePage:function(){var n="/Product-Compare/",t=Crate.ProductCompare.GetSkuCompareArray();t!=null&&(n=n+"?itms="+Crate.ProductCompare.GetSkuCompareArray());window.location=n}},function(n){(function(n){function i(n,t,i){var r,u,f;n.responseJSON.Succeeded===!1?/^\/search$/.test(window.location.pathname)&&/landofnod/i.test(window.location.hostname)?(r=$("<span>").html(n.responseJSON.ResultMessage).find("a")[0].href,u=r+"#r="+location.pathname+location.search,window.location.href=u):(f=$("div.validation-error").length?$("div.validation-error"):$("<div>").addClass("validation-error validation errorMessage"),$("section.availability-messaging").prepend(f.html(n.responseJSON.ResultMessage))):(n.responseJSON.AddType==="addToCart"&&(Crate.AddItem.addToCartOnSuccessDesktop(i,n.responseJSON.Sku,n.responseJSON.Quantity),$(".ui-dialog-titlebar-close").click()),n.responseJSON.AddType==="addToFavorites"&&($("#addToFavoritesButton").addClass("hidden"),$(".addedToFavorites").removeClass("hidden")),n.responseJSON.AddType==="addToRegistry"&&(Crate.AddItem.addToRegistryOnSuccessDesktop(i,n.responseJSON.Sku,n.responseJSON.Quantity),$(".ui-dialog-titlebar-close").click()))}function t(n,t){t=t||"Please provide a ZIP code";var i=new Crate.Val.Form;return i.register({obj:n.val(),errorMsg:Crate.Messages?Crate.Messages.InvalidZip:t,onValidate:Crate.Val.$.IsValidZipCode,domObj:n,onError:function(){this.domObj.val("").addClass(Crate.Config.defaultFormErrorClass);this.domObj.closest("fieldset").find(".validation").html(this.errorMsg).addClass(Crate.Config.defaultFormErrorClass)},onSuccess:function(){this.domObj.val("").removeClass(Crate.Config.defaultFormErrorClass);this.domObj.closest("fieldset").find(".validation").empty().removeClass(Crate.Config.defaultFormErrorClass)}}),i.validate()}function r(n){n?(Crate.Utilities.Cookies.setCookie("zip",n),Crate.Utilities.Cookies.setCookie("zipRemember",n,null,null,45)):console.error("there is no zip code.")}function u(n,i){var u=new Crate.AJAX.ItemRouteUpdate("GetItemRouteUpdate|ItemRouteUpdate"),f,e;u.Route.PostalCode=n;u.FamilyID=i.data("family-id");f=function(t){var u=i.closest(".jsItemRow"),f=i.data("base-sku"),e=t.Availability["SKU_"+f],o=t.InHomeDeliveryMessage["SKU_"+f];r(n);e&&u.find(".message.jsAvailability").empty().html(e);o&&u.find(".jsInHomeMessage").html(o);u.find(".zipcode-entry").fadeOut().addClass("hidden");u.find(".changeZIP").removeClass("hidden").fadeIn()};e=function(n){n&&!n.Success&&n.Error?t(i,n.Error):console.error(n)};u.submit(null,f,e)}n.addComplete=i;n.updateZip=function(n){var i=$(n.target).closest("section").find("#zip-code"),r=i.val();if(!t(i))return!1;u(r,i)};n.revealPanel=function(n){var t=$(n.target).closest("section"),i=t.find(".zipcode-entry");i.find("#zip-code").val(Crate.Utilities.Cookies.getCookie("zip")||"");i.removeClass("hidden").fadeIn();t.find(".changeZIP").fadeOut().addClass("hidden")}})(n.QuickLook||(n.QuickLook={}))}(Crate||(Crate={}));$(function(){$(".reveal-content").each(function(){len=$(this).text().length;height=$(this).prop("scrollHeight");(len<=325||height<=150)&&($(this).parent("div.reveal-container").children(".js-reveal-toggle").addClass("hidden"),$(this).toggleClass("revealed-content"))})});$(document).on("click touchstart",".js-reveal-toggle",function(){$(this).prev(".reveal-content, .reveal-content-hidden").toggleClass("revealed-content");$(this).parent("div.reveal-container-dimensions")&&($(this).parent("div.reveal-container-dimensions").parent().parent().addClass("dimensions-item-opened"),$("#gallery .pswp__caption").addClass("hidden"),$("#gallery .pswp__caption pswp__caption--fake").addClass("hidden"))});(function(n){(function(t){(function(t){function i(){$(document).on("click",".js-miniset-logging,.product-miniset-thumbnail,.product-miniset-title",function(){var t=$(this).attr("data-url"),i=$(this).attr("data-href"),n="/Browse/Search2/LogSearchDetail";$.ajax({url:n,type:"POST",data:{baseLoggingURL:t+"&url="+i},dataType:"json",success:function(){console.log("SLI logging successful. "+n)},error:function(t,i,r){console.log(i,r);console.log("SLI logging failed. "+n)}});console.log("bindSLISearchLoggingToProduct called "+t)})}$(document).ready(function(){n.Model&&n.Model.ActionName.indexOf(".Product.")==-1});t.bindSLISearchLoggingToProduct=i})(t.Search||(t.Search={}));var i=t.Search})(n.Browse||(n.Browse={}));var t=n.Browse})(Crate||(Crate={}));Crate=Crate||{};Crate.SocialShare={init:function(n){Crate.SocialShare.setTwitter(n);$(".jsSocialIcon").hover(function(){$(".jsSocialBox").css("opacity","1");$(".jsSocialBox").hide();$(this).find(".jsSocialBox").show();$(".jsSocialIcon").removeClass("on");$(this).addClass("on")},function(){$(this).find(".jsSocialBox").hide();$(this).removeClass("on")})},initVideo:function(){Crate.SocialShare.setFacebookVideo();Crate.SocialShare.setGooglePlusVideo();Crate.SocialShare.setTwitterVideo();Crate.SocialShare.setPinterestVideo();$("#content a.jsFacebookLink:first").attr("href",Crate.SocialShare.config.facebookPreamble+Crate.SocialShare.config.shortUrl)},initCustom:function(){Crate.SocialShare.setFacebookHub();Crate.SocialShare.setGooglePlusHub();Crate.SocialShare.setTwitterHub();Crate.SocialShare.setPinterestHub();$("#content a.jsFacebookLink:first").attr("href",Crate.SocialShare.config.facebookPreamble+Crate.SocialShare.config.shortUrl)},config:{twitterPreamble:"http://twitter.com/home?status=Look what I found at Crate and Barrel: {$product} - {$url}",facebookPreamble:"http://www.facebook.com/sharer.php?u=",shortUrl:"",itemId:0,swatchId:"",videoThumbUrl:"",videoUrl:"",title:"",iTunesUrl:"",summary:"",img:"",desc:"",mediaSelector:"",mediaAttribute:""},setIdAndSwatch:function(n,t){Crate.SocialShare.config.itemId=n;Crate.SocialShare.config.swatchId=t;Crate.SocialShare.setTwitter()},setTwitter:function(n){var t=window.location.href,i="%3fsw=",r;Crate.SocialShare.config.shortUrl&&(t=Crate.SocialShare.config.shortUrl+Crate.SocialShare.config.itemId,i="%26sw=");Crate.SocialShare.config.swatchId&&(t=t+i+Crate.SocialShare.config.swatchId);n==null&&(n=$("#content .jsShareTitle:first, #jsUI .jsShareTitle:first").html());r=Crate.SocialShare.config.twitterPreamble.replace("{$product}",encodeURIComponent(n)).replace("{$url}",encodeURIComponent(t));$("#content a.jsTwitterLink:first, #jsUI a.jsTwitterLink").attr("href",r)},PinItSpecificImage:function(n){var t,f;n.preventDefault();var i="http://pinterest.com/pin/create/button/",r=$(n.currentTarget).data(),u="?";for(t in r)f=r[t],i+=u+t+"="+encodeURIComponent(f),u="&";window.open(i,"signin","width=665,height=600")},PinItProduct:function(n){var i,r,u,t,f;n.preventDefault();i=$(n.currentTarget).data();image=$(".jsZoomLarge:first").attr("src");r="http://pinterest.com/pin/create/button/";u="?";for(t in i)f=i[t],t=="media"&&(f=image),r+=u+t+"="+encodeURIComponent(f),u="&";window.open(r,"signin","width=665,height=600")},PinIt:function(n){var t,i,r,u,f;n.preventDefault();t=$(n.currentTarget).data();Crate.SocialShare.config.mediaSelector!=""&&Crate.SocialShare.config.mediaAttribute!=""&&(t.media=$(Crate.SocialShare.config.mediaSelector).attr(Crate.SocialShare.config.mediaAttribute));i="http://pinterest.com/pin/create/button/";r="?";for(u in t)f=t[u],i+=r+u+"="+encodeURIComponent(f),r="&";window.open(i,"signin","width=665,height=600")},PinItBrand:function(n){var t,f;n.preventDefault();var i=$(n.currentTarget).data(),r="http://pinterest.com/pin/create/button/",u="?";for(t in i)f=i[t],r+=u+t+"="+encodeURIComponent(f),u="&";window.open(r,"signin","width=665,height=600")},setTwitterVideo:function(){var n=Crate.SocialShare.config.twitterPreamble.replace("{$product}",encodeURIComponent(Crate.SocialShare.config.title)).replace("{$url}",encodeURIComponent(Crate.SocialShare.config.videoUrl));$("#socialShareTwitter_icon").attr("href",n)},setGooglePlusVideo:function(){var n="https://plus.google.com/share?url={$url}".replace("{$url}",encodeURIComponent(Crate.SocialShare.config.videoUrl));$(".iconVSGooglePlus").attr("data-href",n)},setPinterestVideo:function(){var n="http://pinterest.com/pin/create/button/?url={$url}&media={$media}&is_video=true&title={$title}&description={$description}".replace("{$url}",encodeURIComponent(Crate.SocialShare.config.videoUrl)).replace("{$media}",encodeURIComponent(Crate.SocialShare.config.videoThumbUrl)).replace("{$title}",encodeURIComponent(Crate.SocialShare.config.title)).replace("{$description}",encodeURIComponent(Crate.SocialShare.config.title));$(".VidSocialBar #fml_pinit .pin-it-button").attr({href:n,"data-pin-config":"none"})},setFacebookVideo:function(){var n="http://www.facebook.com/sharer.php?u={$url}&t={$title}&is_video=true".replace("{$url}",encodeURIComponent(Crate.SocialShare.config.videoUrl)).replace("{$title}",encodeURIComponent(Crate.SocialShare.config.title));$("#socialShareFB_icon").attr("href",n)},setGooglePlusHub:function(){var n="https://plus.google.com/share?url={$url}".replace("{$url}",encodeURIComponent(Crate.SocialShare.config.shortUrl)),t="javascript:void window.open('"+n+"','_blank', 'menubar=no,location=0,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=755');";$("#socialShareGooglePlus_icon").attr("href",t)},setFacebookHub:function(){var n="http://www.facebook.com/sharer.php?s=100&p[title]={$title}&p[summary]={$summary}&p[url]={$url}&p[images][0]={$img}".replace("{$url}",encodeURIComponent(Crate.SocialShare.config.shortUrl)).replace("{$title}",encodeURIComponent(Crate.SocialShare.config.title)).replace("{$summary}",encodeURIComponent(Crate.SocialShare.config.summary)).replace("{$img}",encodeURIComponent(Crate.SocialShare.config.img)),t="javascript:void window.open('"+n+"','_blank', 'menubar=no,location=0,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=755');";$("#socialShareFB_icon").attr("href",t)},setTwitterHub:function(){var n="http://twitter.com/home?status={$desc} - {$url}".replace("{$desc}",Crate.SocialShare.config.desc),t=n.replace("{$url}",encodeURIComponent(Crate.SocialShare.config.shortUrl)),i="javascript:void window.open('"+t+"','_blank', 'menubar=no,location=0,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=755');";$("#socialShareTwitter_icon").attr("href",i)},setPinterestHub:function(){var n="http://pinterest.com/pin/create/button/?url={$url}&media={$media}&is_video=true&title={$title}&description={$description}".replace("{$url}",encodeURIComponent(Crate.SocialShare.config.videoUrl)).replace("{$media}",encodeURIComponent(Crate.SocialShare.config.videoThumbUrl)).replace("{$title}",encodeURIComponent(Crate.SocialShare.config.title)).replace("{$description}",encodeURIComponent(Crate.SocialShare.config.title)),t="javascript:void window.open('"+n+"','_blank', 'menubar=no,location=0,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=755');";$("#pinItButton").attr({href:t,"count-layout":"none"})}},function(n){(function(t){(function(){function i(){$(".js-share-dialog").removeClass("overlay-hidden");$(".js-social-share").html($.render.socialShareTemplateJs(n.Model))}function r(){console.log("social share dialog closing...");$(".js-share-dialog").addClass("overlay-hidden")}function u(n){return n==!1?window.location.host:t(window.location.host)}function t(n){return encodeURIComponent(n)}function f(n){return n==!1?location.protocol:t(location.protocol)}$(document).ready(function(){$.templates({socialShareTemplateJs:{markup:"#socialShareTemplate",helpers:e}});$(document).on("click",".btn-close",r)});n.Browse.SocialShareDialog.openSocialShareDialog=i;var e={uriEncode:t,UriScheme:f,UriDomain:u}})(t.SocialShareDialog||(t.SocialShareDialog={}));var i=t.SocialShareDialog})(n.Browse||(n.Browse={}));var t=n.Browse}(Crate||(Crate={})),function(n){(function(){function i(n){var i=$(n);i.hover(function(){var n=$(this),i=n.data("alternateimgpath");t(n,i)},function(){var n=$(this),i=n.data("primaryimgpath");t(n,i)})}function t(n,t){n.data("newSrc",t);n.attr("src")!==n.data("newSrc")&&n.show("slow",function(){n.attr("src",n.data("newSrc"));n.show("slow")})}$("#selSortBy").change(n.Forms.Submit);i("img.spillImage")})(n.Spill||(n.Spill={}));var t=n.Spill}(Crate||(Crate={})),function(n){n.sortBy=function(n,t,i){for(var u=[],r=0;r<n.length;r++)u.push(n[r]);return u.sort(function(n,r){var u=t(n),f=t(r),e=u<f;return(u<f?-1:u>f?1:0)*(i?-1:1)}),u};n.fn.extend({sortBy:function(t){var r=[],i=[];return n(this).each(function(n,r){i.push({value:r,criteria:t.call(this,r,n),index:n})}),i.sort(function(n,t){var r=n.criteria,u=t.criteria,i=r<u?-1:r>u?1:0;return i===0&&(i=n.index<t.index?-1:1),i}),n(i).each(function(n,t){r.push(t.value)}),r}})}(jQuery);Crate.Spill={config:{categoryId:-1,isFamily:!1,isRoot:!1,maxResultCount:300,currentRefinement:"",isTablet:!1,validRoot:!1,validNode:!1,loaded:!1,showCat:!0,currentSort:"sequence",searchTerm:null,awaitingScrollRequest:!1,spillComplete:!1},data:null,checkHash:function(){var i=window.location.hash,t,e,r;if(i&&i.length>1){i=window.location.hash.substring(1);var u=i.split("~"),n=u[0],f="sequence";u.length>1&&(f=u[1]);Crate.Spill.config.searchTerm=($.jqURL.get("query")||"").split("#")[0];Crate.Spill.config.searchTerm?t=$.jqURL.get("refinements"):(e=window.location.pathname.split("/"),t=e[e.length-1]);t=="1"&&(t="");n=="1"&&(n="");n!=t&&(r=null,r=Crate.Spill.config.searchTerm?"/search?query="+Crate.Spill.config.searchTerm+"&refinements="+n:"./"+n,f!="sequence"&&(r+="#"+n+"~"+f),window.location=r)}},init:function(){Crate.Spill.data=Crate.Spill.data||[];Crate.Spill.config.categoryId<=0&&!Crate.Spill.config.searchTerm&&(Crate.Spill.config.searchTerm=($.jqURL.get("query")||"").split("#")[0]);Crate.Spill.initHover();$.history.init(function(n){var r,t,i,f,u;if(n.slice(0,6)==="#Crate")return!1;if(r=n.split("~"),t=r[0],t=="1"&&(t=""),i="sequence",r.length>1&&(i=r[1]),Crate.Spill.config.loaded){if(f=!1,t!=Crate.Spill.config.currentRefinement&&(f=Crate.Spill.refine(t,Crate.Spill.config.categoryId,Crate.Spill.config.searchTerm)),f){u=null;u=Crate.Spill.config.categoryId>0?t?"./"+t:"./1":"/search?query="+Crate.Spill.config.searchTerm+"&refinements="+t;i!="sequence"&&(u+="#"+t+"~"+i);window.location=u;return}}else Crate.Spill.config.loaded=!0;i!=Crate.Spill.config.currentSort&&Crate.Spill.sort(i)});Crate.Spill.validate(Crate.Spill.config.isRoot);Crate.Spill.initHover();Crate.Spill.initImageHover("img.spillImage")},hasMoreRefinement:function(n){var t=n.split("_"),r=t[t.length-1],i=r.split("-");return Crate.Utilities.String.startsWith(i[i.length-1],"e")},isUpTheTree:function(n){var t=n.split("_"),i=n?t.length:0,r=Crate.Spill.config.currentRefinement?Crate.Spill.config.currentRefinement.split("_").length:0;return i<r},refine:function(n,t,i){var u,f,r;return(Crate.Debug.trace("Refine: "+n+", "+t+", "+i),u=Crate.Spill.isUpTheTree(n),u&&!Crate.Spill.config.validRoot)?!0:(Crate.Spill.config.currentRefinement=n,f=Crate.Spill.hasMoreRefinement(n),f||Crate.UI.backToTop(),r=new Crate.AJAX.Base("GuidedNavigation|GuidedSearch"),t>0?r.CategoryId=t:r.SearchTerm=i,r.IsProductNeeded=u?!Crate.Spill.config.validRoot:!Crate.Spill.config.validNode,r.RefinementsString=n,r.submit(null,function(n){var r,t,i,u;Crate.Spill.HideThemes();r=Crate.Spill.config.validNode;Crate.Spill.validate(!n.RefinementsString);Crate.Spill.hasMoreRefinement(n.RefinementsString)&&(Crate.Spill.config.validNode=r);Crate.UI.Browser.isIE6()?($("#guidedNavigation").empty().append(n.LeftNav),$("#guidedNavigation:first").children().attr("id",null).attr("class",null)):$("#guidedNavigation").fadeOut(function(){$(this).empty().append(n.LeftNav);$(this).children().attr("id",null).attr("class",null)}).fadeIn(Crate.Spill.postRefinement);n.Data&&(Crate.Spill.data=n.Data);n.Products?(t=$("div.jsSortContainer").hide(),i=$("<div/>"),i.append(t.find(".jsSaveTop")),i.append(n.Products),i.append(t.find(".jsSaveBottom")),t.empty().append(i.children()),Crate.UI.Browser.isIE6()?t.show():t.fadeIn("slow"),Crate.Spill.config.currentSort!="sequence"&&Crate.Spill.sort(Crate.Spill.config.currentSort)):n.Skus&&(u=$("#content div.jsItemRow").attr("rel","inactive"),$.each(n.Skus,function(n,t){var i=$("#MiniSetItem"+t).attr("rel","active");i.is(":hidden")&&(Crate.UI.Browser.isIE6()?i.fadeIn():i.show())}),u.filter("[rel!='active']:visible").attr("rel","inactive").fadeOut());n.Count&&$("#content .searchHeading .jsCount").html(n.Count)}),!1)},postRefinement:function(){Crate.QuickLook.init();Crate.Spill.initHover();Crate.UI.LazyLoad.init()},validate:function(n){n&&(Crate.Spill.config.validRoot=Crate.Spill.data.length<Crate.Spill.config.maxResultCount&&!Crate.Spill.config.isFamily);Crate.Spill.config.validNode=Crate.Spill.data.length<Crate.Spill.config.maxResultCount&&!(Crate.Spill.config.isFamily&&n)},initHover:function(){$("#guidedNavigation li.parentNavItem").hover(function(){$(this).children("span.parentNavItem").addClass("hover");$(this).children(".childNavItem:first").show()},function(){$(this).children("span.parentNavItem").removeClass("hover");$(this).children(".childNavItem").hide()})},HideThemes:function(){$(".jsThemeItem").hide()},ShowThemes:function(){$(".jsThemeItem").show()},showAllRefinements:function(){$("#leftNav").removeClass("hidden").hide().show();$("#showAllRefinementsLink").hide();$("#showLessRefinementsLink").removeClass("hidden").show()},showLessRefinements:function(){$("#leftNav").hide();$("#showAllRefinementsLink").removeClass("hidden").show();$("#showLessRefinementsLink").hide()},showAllRefinementsB:function(){$("#leftNav").removeClass("hidden").hide().show();$("#showAllRefinementsLinkB").hide();$("#showLessRefinementsLinkB").removeClass("hidden").show()},showLessRefinementsB:function(){$("#leftNav").hide();$("#showAllRefinementsLinkB").removeClass("hidden").show();$("#showLessRefinementsLinkB").hide()},sortClick:function(n){var t=$(n.target).attr("rel"),r=Crate.Spill.config.currentRefinement,i;t&&t!="sequence"&&(r+="~"+t);i=new Date;i.setDate(i.getDate()+1);Crate.Utilities.Cookies.setCookieFullExpireDate("Crate.Spill.SessionSort",t,i.toString(),"/");$.history.load(r)},sortClickDetail:function(n){var t=$(n.target).attr("rel"),r=Crate.Spill.config.currentRefinement,i;t&&t!="sequence"&&(r+="&sortBy="+t);i=new Date;i.setDate(i.getDate()+1);Crate.Utilities.Cookies.setCookieFullExpireDate("Crate.Spill.SessionSort",t,i.toString(),"/");$.history.load(r);window.location=r},sortClick2:function(n){var t=n.options[n.selectedIndex].value,r=Crate.Spill.config.currentRefinement,i;t&&t!="sequence"&&(r+="~"+t);i=new Date;i.setDate(i.getDate()+1);Crate.Spill.setCookieFullExpireDate("Crate.Spill.SessionSort",t,i.toString(),"/");this.backToTop(150);$.history.load(r)},setCookieFullExpireDate:function(n,t,i,r,u,f){var e=n+"="+escape(t);i&&(e+="; expires="+i);e+=r?"; path="+escape(r):"; path=/";u&&(e+="; domain="+escape(u));f&&(e+="; secure");document.cookie=e},sortClickDetailItem:function(n){var f=$(n).closest("form"),t=$(n).val(),r=$("#jsSearchTerm").val(),u=$("#jsRefinements").val(),i="/Browse/Search/DisplaySearchDetail";typeof Crate.UI.DropDown=="undefined"&&(i="/Browse/Search/DisplaySearchDetail2");$("#jsSortMethod").val(t);$.ajax({url:i,type:"POST",data:{searchTerm:r,refinements:u,sortBy:t},dataType:"html",success:function(n){Crate.Spill.assignAttributeToSkus(n)},error:function(n,t,i){console.log(t,i)}})},sortClickDetailRefinement:function(){var n=$("#jsSortMethod").val();if(n!=null&&n!=""&&n!="sequence"){var i=$("#jsSearchTerm").val(),r=$("#jsRefinements").val(),t="/Browse/Search/DisplaySearchDetail";typeof Crate.UI.DropDown=="undefined"&&(t="/Browse/Search/DisplaySearchDetail2");$.ajax({url:t,type:"POST",data:{searchTerm:i,refinements:r,sortBy:n},dataType:"html",success:function(n){Crate.Spill.assignAttributeToSkus(n)},error:function(n,t,i){console.log(t,i)}})}},assignAttributeToSkus:function(n){$("#searchItemDetail").html(n)},displayColorAttributeItem:function(n,t,i,r){$.ajax({url:"/Browse/ProductNavigate/DisplayColorAttributeItem",type:"POST",data:{sku:n,position:t,imageSku:i,colorExperience:r},dataType:"html",success:function(i){Crate.Spill.assignAttributeColorToSku(i,t);Crate.Spill.bindFavoritedIcon(n)},error:function(n,t,i){console.log(t,i)}})},displayColorAttributeFamilyItem:function(n,t,i,r){$.ajax({url:"/Browse/ProductNavigate/DisplayColorAttributeFamilyItem",type:"POST",data:{sku:n,position:t,imageSku:i,colorExperience:r},dataType:"html",success:function(i){Crate.Spill.assignAttributeColorToSku(i,t);Crate.Spill.bindFavoritedIcon(n)},error:function(n,t,i){console.log(t,i)}})},assignAttributeColorToSku:function(n,t){$(".jsAttributeItemDetail"+t).replaceWith(n);$(".jsAttributeItemDetail"+t).find(".js-popup").click(Crate.PostPopup.createPopup);Crate.Spill.initHover();Crate.Spill.initImageHover("img.spillImage")},bindFavoritedIcon:function(n){if(Crate.DataHelper!==undefined&&Crate.DataHelper!==null){var t=Crate.DataHelper.getCookie("FavoriteTrackingCookie"),i=Crate.DataHelper.getCookie("Account");(t!=null||i!=null)&&Crate.DesignBoard.GetFavoritedItems([n])}},sortMvc:function(n,t){var i;n&&(i=$(".jsDataHolder").first().data("result"),Crate.Spill.data=Crate.User.ABCrate.SLISearchTest==="A"&&i!==null&&i!==undefined?$.sortBy(i,this.sortOptions[n]):$.sortBy(Crate.Spill.data,this.sortOptions[n]));var r=$("<div/>"),u=$("<div/>"),f=/lan/i.test(t)||/lon/i.test(t);$.each(Crate.Spill.data,function(n,t){var i=$("#jsItemRow"+t.Sku);Crate.User.ABCrate.SLISearchTest=="A"?r.append(i):t.IsOutlet&&!f?u.append(i):r.append(i)});Crate.User.ABCrate.SLISearchTest==="A"&&t==="CB2"?($(".col-xs-9 > .spill-grid > .jsSearchProduct").empty(),$(".col-xs-9 > .spill-grid > .jsSearchProduct").append(r.children()).fadeIn("slow"),$(".jsNextSet300").find(".spill-grid").remove()):($(".jsSearchProduct, .spillContent").empty().append(r.children()).fadeIn("slow"),$(".jsSearchOutlet").empty().append(u.children()).fadeIn("slow"),$(".jsNextSet200").find(".spill-grid").remove());Crate.UI.LazyLoad.Reload()},sort:function(n){var r,i,u,t,f,e,o;if(Crate.Spill.HideThemes(),Crate.Spill.config.currentSort=n,typeof Crate.UI.DropDown=="undefined"){r=$("#selSortBy");r.val(n);Crate.Spill.sortClick2(r[0]);Crate.Spill.sortMvc(n,r.data("site"));return}Crate.UI.DropDown.select("#content div.jsDropDown:first",n);i=$("#content div.jsSortContainer:first").hide();n&&(Crate.Spill.data=$.sortBy(Crate.Spill.data,this.sortOptions[n]));u=Crate.Spill.config.categoryId<=0;t=$("<div/>");u?(t=$("<div/>"),f=$("<div/>")):f=t;u||t.append(i.find(".jsSaveTop"));$.each(Crate.Spill.data,function(n,i){var u=i.Id,r=$("#MiniSetWrapper"+u);i.IsOutlet?f.append(r):t.append(r)});u?(e=i.children(".jsSearchProduct").empty(),o=i.children(".jsSearchOutlet").empty(),i.show(),e.append(t.children()).fadeIn("slow"),o.append(f.children()).fadeIn("slow")):(t.append(i.find(".jsSaveBottom")),i.empty().append(t.children()).fadeIn("slow"));Crate.QuickLook.init();Crate.UI.LazyLoad.Reload()},sortOptions:{sequence:function(n){return n.Sequence},none:function(){return 0},title:function(n){return n.Name},category:function(n){return n.Sequence},priceHighToLow:function(n){return-n.CurrentPriceMax},priceLowToHigh:function(n){return n.CurrentPriceMin},oneOfAFinds:function(n){return!n.MoreColors},sale:function(n){return!n.IsOnSale},relevance:function(n){return n.Relevance},isNew:function(n){return!n.IsNew},shipping:function(n){return!n.IsFreeShipping},colors:function(n){return!n.MoreColors},outlet:function(n){return!n.IsOutlet}},initImageHover:function(n){var t=$(n);t.hover(function(){var n=$(this),t=n.data("alternateimgpath");Crate.Spill.crossFadeImage(n,t)},function(){var n=$(this),t=n.data("primaryimgpath");Crate.Spill.crossFadeImage(n,t)})},crossFadeImage:function(n,t){n.data("newSrc",t);n.attr("src")!==n.data("newSrc")&&n.show("slow",function(){n.attr("src",n.data("newSrc"));n.show("slow")})},sortOptionDescription:function(n){switch(n){case"sequence":return"Sort (default)";case"title":return"by A to Z";case"priceLowToHigh":return"Price, low to high";case"priceHighToLow":return"Price, high to low";default:return n}},backToTop:function(n){var t=$("body").scrollTop()||$("html").scrollTop(),i=n||0;t>150&&$("body, html").animate({scrollTop:i},"slow")}};$(function(){$("img.lazy").lazyload({threshold:100})});$(function(){$(".image-hover-swap").mouseenter(function(){var n=$(this);n.attr("src",n.attr("data-hover")).dequeue().stop().hide().fadeIn(300)});$(".image-hover-swap").mouseleave(function(){var n=$(this);n.fadeOut(300).promise().done(function(){n.attr("src",n.attr("data-original")).fadeIn(1)})})});Crate=Crate||{};Crate.StringResources={_stringResources:null,init:function(){if(Crate.Messages=this._stringResources=this._tryGetCache(),this._stringResources===undefined||this._stringResources===null||Crate.Messages===null){var n=this;try{$.ajax({type:"GET",url:"/browse/commondata/getclientmessages",dataType:"json",contentType:"application/json; charset=UTF-8",success:function(t){t!==undefined&&t!==null&&t.length>0?(Crate.Messages=n._stringResources=JSON.parse(t),n._trySetCache(n._stringResources)):console.log("Warning: String Resource request returned an empty data set.")},error:function(n,t,i){console.log(t+": "+i+": "+n.responseText)}})}catch(t){console.log(t)}}},getResource:function(n,t){return this._stringResources[n]||t},_tryGetCache:function(){var n=null;return window.sessionStorage&&(n=JSON.parse(window.sessionStorage.getItem("Crate.StringResources"))),n},_trySetCache:function(n){window.sessionStorage&&window.sessionStorage.setItem("Crate.StringResources",JSON.stringify(n))}};Crate.Messages=null;Crate.StringResources.init();Crate=Crate||{};Crate.Zoom={config:{defaultImageID:null,defaultImagePosition:0,fullscreenLink:!1,specialPage:!1,familyPageMainImg:!1,familyPageLineLevel:!1},init:function(n,t){var r,u,i;t?n?(r=$("#jsUI").height()-100,u=$("#jsUI").width(),$("#jsUI h2").remove(),$("#jsUI .popupContent:first").css({overflow:"hidden",height:"auto"}),i=$("#jsUI div.jsZoom:first"),i.length>0&&i.zoom(u,r),Crate.Zoom.config.defaultImageID!=null&&Crate.Zoom.config.fullscreenLink==!0&&Crate.Zoom.config.familyPageLineLevel==!1&&(Crate.Zoom.config.specialPage==!1||Crate.Zoom.config.familyPageMainImg==!0)&&Crate.Zoom.updateImagePopUp(Crate.Zoom.config.defaultImageID)):(i=$("#jsUI div.jsZoom:first"),i.length>0&&i.zoom(u,r)):$(function(){$("div.jsZoom:first").zoom()})},imageInit:function(){Crate.Zoom.config.defaultImageID=null},GiftCardinit:function(n){var t=$(n);$(function(){t.zoom()})},imageInit:function(){Crate.Zoom.config.defaultImageID=null},replaceFirstImage:function(n){$("#content .jsZoom:first").zoomReplaceFirstImage(n);$("#content .jsZoomImages:first li a").removeClass("selectedImage");$("#content .jsZoomImages:first li:first a").addClass("selectedImage")},updateImagePopUp:function(n){$("#jsUI .jsZoomLarge:first").zoomReplaceFirstImagePopUp(n)}}